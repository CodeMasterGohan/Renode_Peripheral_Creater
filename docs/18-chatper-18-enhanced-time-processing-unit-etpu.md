### Chatper 18 Enhanced Time Processing Unit (eTPU)

## 18.1 Introduction

The enhanced time processing unit (eTPU) is a new timing unit featured on the MPC5553/MPC5554 microcontroller that operates in parallel with the MPC5553/MPC5554 core (CPU). The eTPU does the following:

- · Executes programs independently from the host core
- · Detects and precisely records timing of input events
- · Generates complex output waveforms
- · Is controlled by the core without a requirement for real-time host processing

The  host  core  setup  and  service  times  for  each  input  and  output  event  are  greatly  minimized.  The MPC5554 contains two eTPUs, and the MPC5553 contains one.

The eTPU improves the performance of the MPC5553/MPC5554 by providing high resolution timing:

- · eTPU dedicated channels that include two match and two capture registers, as opposed to the previous generation TPUs which only had one of each register
- · eTPU engines that are optimized with specific instructions to service channel hardware
- · The fast instruction execution rate of the eTPU engine that reduces service time

Because responding to hardware service requests is primarily done by the eTPU engine, the host is free to handle higher level operations.

## 18.1.1 The MPC5553/MPC5554 eTPU Implementation

For more detailed information regarding the eTPU module and compiler, refer to the Enhanced Time Processing (eTPU) Reference Manual. The MPC5553/MPC5554 devices contain a specific implementation of the eTPU's full functionality. This chapter will focus only on an eTPU overview and those details that are different than the full instantiation of the module. These differences include the following:

- · 3 (MPC5554) or 2.5 (MPC5553) Kbytes of shared data memory (SDM). This memory is alternately referred to as eTPU shared parameter (data) RAM (SPRAM).
- · 16 Kbytes (MPC5554) or 12 Kbytes (MPC5553) of shared code memory (SCM).
- · For the MPC5553, only one eTPU engine: eTPU A in the eTPU reference manual. Ignore any references to eTPU B.
- · The eTPU debug interface is built into the MPC5553/MPC5554's debug module. Refer to Section 10.2.1 of the eTPU reference manual for details on eTPU debug.
- · Data transfer requests are implemented as a single DMA request to the MPC5553/MPC5554's DMA controller. All 32 channels' data transfer request signals are logically OR'd to produce the single DMA request.
- · I/O channel pairs may be shared on a common pin. The output buffer enable (OBE) is not used in the MPC5553/MPC5554. The outputs are enabled in the SIU; refer to Chapter 6, 'System Integration Unit (SIU).'

Because of the above differences between the MPC5553/MPC5554's implementation of the eTPU and the full eTPU, full register bit descriptions are included within this chapter as well as in the Enhanced Time Processing (eTPU) Reference Manual.

## 18.1.2 Block Diagram

Figure 18-1  shows  a  top-level  eTPU  block  diagram.  It  displays  the  MPC5554's  dual  eTPU  engine configuration.

## NOTE

The MPC5553 has a single eTPU engine configuration, and the MPC5554 has two.

Figure 18-1. eTPU Block Diagram

<!-- image -->

Figure 18-2 shows the block diagram for the eTPU engine.

Figure 18-2. eTPU Engine Block Diagram

<!-- image -->

## 18.1.3 eTPU Operation Overview

The eTPU is a real-time microprocessed subsystem. Therefore it runs microengine code from instruction memory (SCM) to handle specific events and accesses data memory (SDM) for parameters, work data, and application state information. Events may originate from I/O channels (due to pin transitions and/or time base matches), MPC5553/MPC5554 core requests, or inter-channel requests. Events that call for local eTPU processing activate the microengine by issuing a service request. The service request microcode may send an interrupt to the MPC5553/MPC5554 core, but the core cannot be directly interrupted by I/O channel events.

Each  channel  is  associated  with  a  function  that  defines  its  behavior.  A  function  is  a  software  entity consisting of a set of microengine routines, called threads, that respond to eTPU service requests. Function routines, which reside in the SCM, are also responsible for channel configuration. A function may be

## Enhanced Time Processing Unit (eTPU)

assigned to several channels, but a channel can only be associated with one function at a given moment. The  eTPU  has  the  capability  to  change  the  function  assigned  to  a  channel  if  reconfigured  by  the MPC5553/MPC5554  core.    The  association  between  functions  and  channels  is  defined  by  the MPC5553/MPC5554 core.

The eTPU hardware supplies resource sharing features that support concurrency:

- · A hardware scheduler dispatches the service request microengine routines based on a set of priorities defined by the MPC5553/MPC5554's core. Each channel has its own unique priority assignment that primarily depends on CPU assignment. The channel's number is an inherent property also used to determine priority.
- · A service request routine cannot be interrupted by another service request until it ends, that is, until an end instruction is executed. This sequence of uninterrupted instruction execution is called a thread. A thread may be interrupted only by resetting the entire eTPU module.
- · Channel-specific contexts (registers and flags) are automatically switched between the end of a thread and the beginning of the next one.
- · SDM arbitration, a dual-parameter coherency controller, and semaphores can be used to ensure coherent access to eTPU data shared by both eTPU engines and the MPC5553/MPC5554 core.

## 18.1.3.1 eTPU Engine

The eTPU engine processes input pin transitions and generates output pin waveforms. These events are triggered by eTPU timers (time bases) that are driven by a system clock to give absolute time control or by an asyncronous counter such as an angle clock that may be tracking the angle of a rotating shaft.

Each eTPU engine consists of the following blocks: 32 independent timer channels, a task scheduler, a host interface, and a microprocessor (hereinafter called a microengine) that has dedicated hardware for input signal processing and output signal generation over the 32 I/O channels. Each channel can also choose between two 24-bit counter registers for a time base.

The microengines fetch microinstructions from shared code memory (SCM). eTPU application parameters and global and local variables, referred to as work data, are held in 32-bit shared data memory (SDM), which is also used for passing information between the MPC5553/MPC5554's core and both (or one) microengines. The bus interface unit (BIU) allows the MPC5553/MPC5554's core to access eTPU registers, SDM, and SCM.

The blocks of an eTPU engine are duplicated in a dual eTPU configuration. eTPU engines A and B are often referred to as eTPU A and eTPU B in this document.

## 18.1.3.1.1 Time Bases

Each eTPU engine has two 24-bit count registers TCR1 and TCR2 that provide reference time bases for all match and input capture events. Prescalers for both time bases are controlled by the MPC5553/MPC5554 core through bit fields in the eTPU engine configuration registers.

The values for each of TCR1 and TCR2 counter registers can be independently derived from the system clock or from an external input via the TCRCLK pin. In addition, the TCR2 time base can be derived from special angle-clock hardware that enables implementing angle-based functions. This feature is added to support advanced angle-based engine control applications.

The TCRs may also drive or be driven by an eMIOS time base through the shared time and counter (STAC) bus, or they may be written by eTPU function software.

## 18.1.3.1.2 eTPU Timer Channels

Each eTPU engine has 32 identical, independent channels. Each channel corresponds to an input/output signal pair. Every channel has access to two 24-bit counter registers, TCR1 and TCR2.

Each channel consists of event logic which supports a total of four events, two capture and two match events. The event logic contains two 24-bit capture registers and two 24-bit match registers. The match registers are compared to a selected TCR by greater-than-or-equal-to and equal-only comparators. The match and compare register pairs enable many combinations of single and double-action functions.

The channel configuration can be changed by the microengine. Each channel can perform double capture, double match or a variety of other capture-match combinations. Service requests may be generated on one or both of the match events and/or on one of the capture events.

Digital filters that have different filtering modes are provided for the input signals.

Every channel can use any time base or angle counter for either match or capture operation. For example, a match on TCR1 can capture the value of TCR2. The channels can request service from the microengine due to recognized pin transitions (input events) or time base matches.

Every eTPU channel may be configured with the following combinations:

- · Single input capture, no match (TPU3 functionality)
- · Single input capture with single match time-out (TPU3 functionality)
- · Single input capture with double match time-out with several double match submodes
- · Double input capture with single or double match time-out with several double match submodes
- · Single output match (TPU3 functionality)
- · Double output match with several double match submodes
- · Input-dependent output generation

The  double  match  functionality  has  various  combinations  for  generation  of  service  request  and determining pin actions.

## 18.1.3.1.3 Host Interface

The engine's host interface allows the MPC5553/MPC5554 core to control the operation of the eTPU. In order for the eTPU to start operation, the MPC5553/MPC5554 core must initialize the eTPU by writing to the appropriate host interface registers to assign a function and priority to each channel. In addition, the MPC5553/MPC5554 core writes to the host service request and channel configuration registers to further define operation for each initialized channel.

## NOTE

The host transfers the code image for the eTPU microcode to the SCM, then the host enables eTPU access to the SCM (which also disables host access).

## 18.1.3.1.4 Shared Data Memory (SDM)

The SDM works as data RAM that can be accessed by the MPC5553/MPC5554 core and up to two eTPU engines. This memory is used for either:

- · Information transfer between the MPC5553/MPC5554 core and the eTPU
- · Data storage for the eTPU microcode program
- · Communication between the two eTPU engines

The SDM width is 32 bits, and is accessible by the host in any of the three formats: byte, 16-bit, or 32-bit. The eTPU can access the SDM's full 32 bits, lower 24 bits or upper byte (8-bit).

## Enhanced Time Processing Unit (eTPU)

The host can also access the SDM space mirrored in an alternate area with parameter sign extension (PSE). PSE  allows for 24-bit data to be accessed as 32 bit sign-extended data without using the MPC5553/MPC5554's bandwidth to extend the data.

Parameter  signal  extension  accesses  differ  from  the  usual  host  accesses  to  the  original  SDM  area  as follows:

- · Writes are effective only to the lower 3 bytes of a word: the word's most significant byte (byte address) is kept unaltered in SDM.

Figure 18-3. SDM Write

<!-- image -->

## NOTE

For the most significant byte, it should be recalled that the word format is big endian, as in the default PowerPC word format.

- · Reads return the lower 3 bytes of a word sign-extended to 32 bits, that is: the most significant bit of the word's second most significant byte (byte addresses) is copied in all 8 bits of the most significant read byte.

Figure 18-4. PSE Accesses

<!-- image -->

Each eTPU channel can be associated with a variable number of parameters located in the SDM, according to its selected function. In addition, the SDM can be fully shared between two eTPU engines, enabling communication between them. Each function may require a different number of parameters. During eTPU initialization  the  host  has  to  program  channel  base  addresses,  allocating  proper  parameters  for  each channel according to its selected function.

In the host address space each parameter occupies four bytes (32 bits). eTPU usage of the upper byte is achieved by having a 32-bit Preload (P) register that can access the upper byte, the lower 24 bits, or all the 32 bits. The microcode can switch between access sizes at any time.

Each function may require a different number of parameters. During the eTPU initialization the host has to program channel base addresses, allocating proper parameters for each channel according to its selected function.

## 18.1.3.1.5 Task Scheduler

As mentioned in Section 18.1.3, 'eTPU Operation Overview' every channel function is composed of one or more threads, and threads cannot be interrupted by host or channel events, such as channel servicing. The function of the task scheduler, therefore, is to recognize and prioritize the channels needing service and grant execution time to each channel. The time given to an individual thread for execution or service is called a time slot. The duration of a time slot is determined by the number of instructions executed in the thread plus SDM wait-states received, and varies in length. Although several channels may request service at the same time, the function threads must be executed serially.

At any time, an arbitrary number of channels can require service. The channel logic, eTPU microcode, or the host application notifies the scheduler by issuing a service request.

Out of reset, all channels are disabled. The MPC5553/MPC5554 core makes a channel active by assigning it one of three priorities: high, middle, or low. The scheduler determines the order in which channels are serviced  based  on  channel  number  and  assigned  priority.  The  priority  mechanism,  implemented  in hardware, ensures that all requesting channels are serviced.

## 18.1.3.1.6 Microengine

The eTPU microengine is a simple RISC implementation that performs each instruction in a microcycle of two system clocks, while pre-fetching the next instruction through an instruction pipeline. Instruction execution  time  is  constant  for  the  arithmetic  logic  unit  (ALU)  unless  it  gets  wait  states  from  SDM arbitration.

Microcode is stored in shared code memory (SCM) that is 32 bits wide. The microengine instruction set provides basic arithmetic and logic operations, flow control (jumps and subroutine calls), SDM access, and channel configuration and control. The instruction formats are defined in such a way that allow particular combinations of two or three of these operations with unconflicting resources to be executed in parallel in the same microcycle, thus improving performance.

The  microengine  also  has  an  independent  multiply/divide/MAC  unit  that  performs  these  complex operations in parallel with other microengine instructions.

Channel  functionality  is  integrated  to  the  instruction  set  through  channel  control  operations  and conditional  branch  operations,  which  support  jumps/calls  on  channel-specific  conditions.  This  allows quick and terse channel configuration and control code, contributing to reduced service time.

## 18.1.3.1.7 Dual eTPU Engine System (MPC5554 Only)

The MPC5554 eTPU implementation includes two eTPU engines sharing SDM and the same code in the SCM.

The two eTPU engines share the bus interface unit (BIU) and the shared data memory (SDM). This allows the MPC5554 core to communicate with the eTPU and also provides a means of communication between the eTPU engines. The shared BIU includes coherency logic which supports dual parameter (8 bytes) coherency in transfers between the host and eTPU, using a temporary parameter area within the SDM.

## 18.1.3.2 Debug Interface

Nexus level 3 debug support is available through the eTPU Nexus development interface (NDEDI). Refer to Chapter 25, 'Nexus Development Interface.'

## 18.1.4 Features

The eTPU includes these distinctive features:

- · Up to 32 channels for each eTPU engine: each channel is associated with an I/O signal pair
- - Enhanced input digital filters on the input pins for improved noise immunity. The eTPU digital filter can use two samples, three samples, or work in continuous mode.
- - Orthogonal channels, except for channel 0: each channel can perform any time function. Each time function can be assigned to more than one channel at a given time, so each signal can have any functionality. Channel 0 has the same capabilities of the others, but can also work with special angle counter logic (see below).
- - A link service request allows activation of a channel thread by request of another channel, even between eTPU engines.
- - A host service request allows activation of a channel thread by the MPC5553/MPC5554 core request.
- - Each channel has an event mechanism that supports single and double action functionality in various combinations. It includes two 24-bit capture registers, two 24-bit match registers, 24-bit greater-equal or equal-only comparator.
- · Two independent 24-bit time bases for channel synchronization
- - The first time base may be clocked by the system clock with programmable prescaler division from 2 to 512 (in steps of 2), or by the output of the second time base prescaler.
- - The first time base can also be clocked by an external signal with programmable prescaler divisions of 1 to 256.
- - The second time base may be clocked by an external signal with programmable prescaler divisions from 1 to 64 or by the system clock divided by 8.
- - The second time base counter can work as an angle counter, enabling angle-based applications to match angle instead of time.
- - The second time base can alternatively be used as a pulse accumulator gated by an external signal.
- - Either time base can be written or read by either eTPU engine at any time.
- - Either time base can be read, but not written, by the host.
- - Both time bases can be exported or imported from engine to engine through the STAC (shared time and counter) bus.

## NOTE

An engine cannot export/import to/from itself. An engine cannot import a time base and/or angle count if it is in angle mode.

- · Event-triggered RISC processor (microengine)
- - 2-stage pipeline implementation (fetch and execution), with separate instruction memory (SCM) and data memory (SDM).
- - Two-system-clock microcycle fixed-length instruction execution for the ALU.
- - 16 Kbytes (MPC5554) or 12 Kbytes (MPC5553) of shared code memory (SCM).

- - Interleaved SCM access in dual-engine eTPU (MPC5554) avoids contention in time for instruction memory.
- - 3 (MPC5554) or 2.5 (MPC5553) Kbytes of shared data memory (SDM) with interleaved access in dual (MPC5554) eTPU engine avoids contention for data memory.
- - Instruction set with embedded channel support, including specialized channel control subinstructions and conditional branching on channel-specific flags.
- - Channel-oriented addressing: channel-bound address mode with host configured channel base address allows the same function to operate independently on different channels.
- - Channel-bound data address space of up to 128 32-bit parameters (512 bytes).
- - Global parameter address mode allows access to common channel data of up to 256 32-bit parameters (1024 bytes).
- - Support for indirect and stacked data access schemes.
- - Parallel execution of: data access, ALU, channel control and flow control subinstructions in selected combinations.
- - 32-bit microengine registers and 24-bit resolution ALU, with 1 microcycle addition and subtraction, absolute value, bitwise logical operations on 24-bit, 16-bit, or byte operands: single bit manipulation, shift operations, sign extension and conditional execution.
- - Additional 24-bit multiply/MAC/divide unit which supports all signed/unsigned/ multiply/MAC combinations, and unsigned 24-bit divide. The MAC/divide unit works in parallel with the regular microcode commands.
- · Resource sharing features resolve channel contention for common use of channel registers, memory and microengine time
- - Hardware scheduler works as a 'task management' unit, dispatching event service routines by predefined, host-configured priority.
- - Automatic channel context switch when a 'task switch' occurs; that is, one function thread ends and another begins to service a request from another channel. Channel-specific registers, flags and parameter base address are automatically loaded for the next serviced channel.
- - Individual channel priority setting in three levels: high, middle, and low.
- - Scheduler priority scheme allows calculation of worst case latency for event servicing and ensures servicing of all channels by preventing permanent blockage.
- - SDM shared between host core and both eTPU engines, supporting channel-channel or host-channel communication.
- - Hardware implementation of four semaphores allows for resource arbitration  between channels in both eTPU engines.
- - Hardware semaphores are directly supported by the microengine instruction set.
- - Dual-parameter coherency hardware support allows coherent (to host) access to 2 parameters by microengines in back-to-back accesses.
- - Coherent dual-parameter controller allows coherent (to microengines) accesses to two parameters by the host.
- · Test and development support features
- - Nexus level 3 debug support through the eTPU Nexus block (NDEDI)
- - Software breakpoints
- - SCM (code memory) continuous signature-check built-in code integrity test multiple input signature calculator (MISC): runs concurrently with eTPU normal operation

## 18.2 Modes of Operation

The eTPU is capable of working in the following modes.

## 18.2.1 User Configuration Mode

By having access to the shared code memory (SCM), the core has the ability to program the eTPU cores with  time functions.

## 18.2.2 User Mode

In user mode the core does not access the eTPU shared code memory, and pre-defined eTPU functions are used.

## 18.2.3 Debug Mode

The core debugs eTPU code, accessing special trace/debug features via Nexus interface:

- - Hardware breakpoint/watchpoint setting
- - Access to internal registers
- - Single-step execution
- - Forced instruction execution
- - Software breakpoint insertion and removal

## 18.2.4 Module Disable Mode

eTPU engine clocks are stopped through a register write to ETPU\_ECR bit MDIS, saving power. Input sampling stops. eTPU engines can be in stop mode independently. Module disable mode stops only the engine clock, so that the shared BIU and global channel registers can be accessed, and interrupts and DMA requests  can  be  cleared  and  enabled/disabled.  An  engine  only  enters  module  disable  mode  when  any currently running thread is finished.

These modes are loosely selected: there is no unique register field or signals to choose between them. Some features of one mode can be used with features of other modes.

## 18.2.5 eTPU Mode Selection

User and user configuration are the production operating modes, and differ from each other only in access to SCM.

Module disable mode is entered by setting ETPU\_ECR[MDIS]. eTPU engines can be individually stopped (there is one ETPU\_ECR for each engine).

## 18.3 External Signal Description

## 18.3.1 Overview

There are 69 external signals associated with each eTPU engine: 32 channel input signals, 32 channel output signals, 4 output disable signals, and a TCRCLK clock input, totalling 138 in a dual engine system, or 69 in a single engine system.

## 18.3.2 Detailed Signal Description

## 18.3.2.1 Output and Input Channel Signals

The channel signal connections for eTPU engine A (in both the MPC5553 and the MPC5554) and eTPU engine B (only in the MPC5554) are described in Table 18-1 and Table 18-2, respectively. Each eTPU channel has an input and output associated with it. In Table 18-1 and Table 18-2 this is represented by the Input/output column. The eTPU channels can be connected to external pins or wired internally to other peripheral devices. In the MPC5553/MPC5554, some of the eTPU channels are connected to pins. The pin connections are represented by the Pin Number column in Table 18-1 and Table 18-2. To the right of the Pin  Number  column  is  the  eTPU  Channel  Connections  column  that  shows  the  channel  number  that corresponds to each input or output pin. Many of these pins are multipurpose, that is they are multiplexed. Table 18-1 and Table 18-2 shows the other non-eTPU signals listed in the Signals with Which eTPU Signal is Shared column.

To reduce the number of pins required by the MPC5553/MPC5554's eTPU while still maintaining the eTPU's functionality, the eTPU is also internally wired to the DSPI (20.1, 'Introduction'). The DSPI connections  are  shown  in  the  column  labeled  DSPI  Serial  Channel  Connections  in  Table 18-1  and Table 18-2. The eTPU microcode may be programmed to set the output level of an eTPU channel in one of two manners:

- · By forcing the logic level to a specified value
- · By specifying the logic level output action when a match or transition event occurs

Every eTPU channel input has a digital filter. This filter is designed to filter out noise pulses that have width  less  than  a  specified  value.  This  prevents  small  noise  glitches  from  being  recognized  by  the transition  detect  logic.  Any  pulses  wider  than  the  specified  filter  width  will  be  passed  to  the  channel transition detect logic.

Table 18-1. eTPU A Channel Connection Table (both MPC5553 and MPC5554)

| eTPU Channel Number   | I/O   | Pin Number                                             | eTPU Channel Connections   | DSPI Serial Channel Connections   | eTPU A Signal   | Signals with Which eTPU Signal is Shared:   |
|-----------------------|-------|--------------------------------------------------------|----------------------------|-----------------------------------|-----------------|---------------------------------------------|
| 0-9                   | I     | N3 M4-M1 1 L4-L1 1 K4                                  | 0 1-4 5-8 9                | not connected                     | eTPU_A[0:9]     | eTPU_A[12:21] (output only) GPIO[114:123]   |
| 0-9                   | I     | N3 M4-M1 1 L4-L1 1 K4                                  | 0 1-4 5-8 9                | DSPI_C[4:13]                      | eTPU_A[0:9]     | eTPU_A[12:21] (output only) GPIO[114:123]   |
| 0-9                   | O     | AF15, AE15, AC16, AD15,AF16,AE16, AD16,AF17,AC17, AE17 | 0-9                        | DSPI_C[4:13]                      | eTPU_A[0:9]     | eMIOS[0:9] GPIO[179:188]                    |
| 10-11                 | I     | K3-K2 1                                                | 10-11                      | not connected                     | eTPU_A[10:11]   | eTPU_A[22:23] (output only) GPIO[124:125]   |
| 10-11                 | O     | K3-K2 1                                                | 10-11                      | DSPI_C[14:15]                     | eTPU_A[10:11]   | eTPU_A[22:23] (output only) GPIO[124:125]   |
| 12-15                 | I     | K1 J4-J2 1                                             | 12 13-15                   | not connected                     | eTPU_A[12:15]   | GPIO[126:129]                               |
| 12-15                 | I     | K1 J4-J2 1                                             | 12 13-15                   | DSPI_C[0:3]                       | eTPU_A[12:15]   | GPIO[126:129]                               |
| 12-15                 | O     | N3 M4-M2 1                                             | 12 13-15                   | DSPI_C[0:3]                       | eTPU_A[12:15]   | eTPU_A[0:3] GPIO[114:117]                   |

Table 18-1. eTPU A Channel Connection Table (both MPC5553 and MPC5554)  (continued)

| eTPU Channel Number   | I/O   | Pin Number    | eTPU Channel Connections   | DSPI Serial Channel Connections   | eTPU A Signal   | Signals with Which eTPU Signal is Shared:   |
|-----------------------|-------|---------------|----------------------------|-----------------------------------|-----------------|---------------------------------------------|
| 16-19                 | I     | J1 H4-H2 1    | 16 17-19                   | not connected                     | eTPU_A[16:19]   | GPIO[130:133]                               |
| 16-19                 | I     | J1 H4-H2 1    | 16 17-19                   | DSPI_B[7:4] 1 DSPI_D[5:2] 1       | eTPU_A[16:19]   | GPIO[130:133]                               |
| 16-19                 | O     | M1 L4-L2 1    | 16 17-19                   | DSPI_B[7:4] 1 DSPI_D[5:2] 1       | eTPU_A[16:19]   | eTPU_A[4:7] GPIO[118:121]                   |
| 20-21                 | I     | H1 G4         | 20 21                      | not connected                     | eTPU_A[20:21]   | IRQ[8:9] (input only) GPIO[134:135]         |
| 20-21                 | I     | H1 G4         | 20 21                      | DSPI_B[3:2] 1 DSPI_D[1:0] 1       | eTPU_A[20:21]   | IRQ[8:9] (input only) GPIO[134:135]         |
| 20-21                 | O     | L1 K4         | 20 21                      | DSPI_B[3:2] 1 DSPI_D[1:0] 1       | eTPU_A[20:21]   | eTPU_A[8:9] GPIO[122:123]                   |
| 22-23                 | I     | G2 G1         | 22 23                      | not connected                     | eTPU_A[22:23]   | IRQ[10:11] (input only) GPIO[136:137]       |
| 22-23                 | O     | K3 K2         | 22 23                      | not connected                     | eTPU_A[22:23]   | eTPU_A[10:11] GPIO[124:125]                 |
| 24-27                 | I     | -             | not connected              | DSPI_B[13:10] 1                   | eTPU_A[24:27]   | not connected                               |
| 24-27                 | O     | F1, G3 F3, F2 | 24, 25 26, 27              | DSPI_B[13:10] 1 DSPI_D[15:12] 1   | eTPU_A[24:27]   | IRQ[12:15] (input only) GPIO[138:141]       |
| 28-29                 | I     | -             | not connected              | DSPI_B[9:8] 1                     | eTPU_A[28:29]   | not connected                               |
| 28-29                 | O     | E1 E2         | 28 29                      | DSPI_B[9:8] 1 DSPI_D[11:10] 1     | eTPU_A[28:29]   | GPIO[142:143]                               |
| 30-31                 | I     | D1 D2         | 30 31                      | not connected                     | eTPU_A[30:31]   | GPIO[144:145]                               |
| 30-31                 | O     | D1 D2         | 30 31                      | not connected                     | eTPU_A[30:31]   | GPIO[144:145]                               |

1 The channel numbers for some of the DSPI channels connections are reversed, for example if eTPU\_A[16:19] is mapped to DSPI\_B[7:4], then eTPU\_A16 is connected to DSPI\_B7, eTPU\_A17 is connected to DSPI\_B6,..., and eTPU\_A19 is connected to DSPI\_B4

## Table 18-2. eTPU B Channel Connection Table (MPC5554 Only)

| eTPU Channel Number   | I/O   | Pin Number                                     | eTPU Channel Connections   | DSPI Serial Channel Connections   | eTPU B Signal   | Signals with Which eTPU Signal is Shared:   |
|-----------------------|-------|------------------------------------------------|----------------------------|-----------------------------------|-----------------|---------------------------------------------|
| 0-7                   | I     | M25, M24, L26, L25, L24, K26, L23, K25         | 0-7                        | not connected                     | eTPU_B[0:7]     | eTPU_B[16:23] (output only) GPIO[147:154]   |
| 0-7                   | I     | M25, M24, L26, L25, L24, K26, L23, K25         | 0-7                        | DSPI_A[15:8] 1                    | eTPU_B[0:7]     | eTPU_B[16:23] (output only) GPIO[147:154]   |
| 0-7                   | O     | AE19, AD19, AF20, AE20, AF21, AC19, AD20, AF21 | 0-7                        | DSPI_A[15:8] 1                    | eTPU_B[0:7]     | eMIOS[16:23] GPIO[195:202]                  |
| 8-15                  | I     | K24, J26, K23, J25, J24, H26, H25, G26         | 8-15                       | not connected                     | eTPU_B[8:15]    | eTPU_B[24:31] (output only) GPIO[155:162]   |
| 8-15                  | O     | K24, J26, K23, J25, J24, H26, H25, G26         | 8-15                       | DSPI_A[7:0] 1                     | eTPU_B[8:15]    | eTPU_B[24:31] (output only) GPIO[155:162]   |

## MPC5553/MPC5554 Microcontroller Reference Manual, Rev. 3.1

Table 18-2. eTPU B Channel Connection Table (MPC5554 Only)

| eTPU Channel Number   | I/O   | Pin Number                                                                     | eTPU Channel Connections   | DSPI Serial Channel Connections   | eTPU B Signal   | Signals with Which eTPU Signal is Shared:   |
|-----------------------|-------|--------------------------------------------------------------------------------|----------------------------|-----------------------------------|-----------------|---------------------------------------------|
| 16-31                 | I     | D16, D17, A17, C16, A18, B17, C17, D18, A19, B18, C18, A20, B19, D19, C19, B20 | 16-31                      | not connected                     | eTPU_B[16:31]   | GPIO[163:178]                               |
| 16-31                 | O     | D16, D17, A17, C16, A18, B17, C17, D18, A19, B18, C18, A20, B19, D19, C19, B20 | 16-31                      | not connected                     | eTPU_B[16:31]   | GPIO[163:178]                               |

1 The channel numbers for some of the DSPI channels connections are reversed, for example if eTPU\_B[0:7] is mapped to DSPI\_A[15:8], then eTPU\_B[0] is connected to DSPI\_A[15], eTPU\_B[1] is connected to DSPI\_A[14],..., eTPU\_B[7] is connected to DSPI\_A[8].

## 18.3.2.2 Time Base Clock Signal (TCRCLK[A:B])

The TCRCLK[A:B] input signals are used to control the TCR1 and TCR2 time bases for eTPU A and eTPU B.

## NOTE

Throughout  this  document,  TCRCLKA  and  TCRCLKB  are  referred  to generically as TCRCLK.

There  is  one  independent  TCRCLK  input  for  each  engine.  Table 18-3  shows  the  TCRCLK  pin connections. For pulse accumulator operations TCRCLK can be used as a gate for a counter based on the system clock divided by eight. For angle operations TCRCLK can be used to get the tooth transition indications in angle mode. Further details can be found in the eTPU reference manual's Section 5.9 and 5.10.

Table 18-3. TCRCLK Signals

| Signal Name   | Pin Connection   | Other Signals Muxed on Same Pin   |
|---------------|------------------|-----------------------------------|
| TCRCLKA       | N4               | IRQ7 (input only) GPIO113         |
| TCRCLKB 1     | M23              | IRQ6 (input only) GPIO146         |

1 TCRCLKB is implemented only in the MPC5554.

## 18.3.2.3 Channel Output Disable Signals

Each eTPU engine has four input signals that are used to force the outputs of a group of 8 channels to an inactive level. These signals originate from the eMIOS. When an output disable signal is active, all the 8 channels assigned to the disable signal that have their ODIS bits set to 1 in ETPU\_C n CR register have their outputs forced to the opposite of the value specified in the ETPU\_C n CR[OPOL] bit. Therefore, individual channels can be selected to be affected by the output disable signals, as well as their disabling forced polarity.

The output disable channel groups are defined in Table 18-4.

Table 18-4. Output Disable Channel Groups

|   eMIOS Channel | Engine   | eTPU Channels Disabled   |
|-----------------|----------|--------------------------|
|              11 | A        | 0-7                      |
|              10 | A        | 8-15                     |
|               9 | A        | 16-23                    |
|               8 | A        | 24-31                    |
|              20 | B        | 0-7                      |
|              21 | B        | 8-15                     |
|              22 | B        | 16-23                    |
|              23 | B        | 24-31                    |

## 18.4 Memory Map/Register Definition

## 18.4.1 Memory Map

The eTPU system simplified memory map is shown in Table 18-5. The base address for the eTPU module is listed as BASE. Each of the register areas shown may have their own reserved address areas.

Table 18-5 shows a detailed memory map.

Table 18-5. eTPU High-Level Memory Map

| Address                          | Register Description                       |
|----------------------------------|--------------------------------------------|
| Base- Base + 0x0_001F            | eTPU system module configuration registers |
| Base + 0x0_0020- Base + 0x0_002F | eTPU A time base registers                 |
| Base + 0x0_0030- Base + 0x0_003F | Reserved                                   |
| Base + 0x0_0040- Base + 0x0_004F | eTPU B time base registers                 |
| Base + 0x0_0050- Base + 0x0_01FF | Reserved                                   |
| Base + 0x0_0200- Base + 0x0_02FF | eTPU[A:B] global channel registers         |
| Base + 0x0_0300- Base + 0x0_03FF | Reserved                                   |
| Base + 0x0_0400- Base + 0x0_07FF | eTPU A channel registers                   |
| Base + 0x0_0800- Base + 0x0_0BFF | eTPU B channel registers                   |

Table 18-5. eTPU High-Level Memory Map (continued)

| Address                          | Register Description                                              |
|----------------------------------|-------------------------------------------------------------------|
| Base + 0x0_0C00- Base + 0x0_7FFF | Reserved                                                          |
| Base + 0x0_8000- Base + 0x0_8BFF | SDM (3 Kbytes)                                                    |
| Base + 0x0_8C00- Base + 0x0_BFFF | Reserved                                                          |
| Base + 0x0_C000- Base + 0x0_CBFF | SDM PSE mirror 1 (3 Kbytes)                                       |
| Base + 0xCC00- Base + 0xFFFF     | Reserved                                                          |
| Base + 0x1_0000- Base + 0x1_3FFF | SCM (16 Kbytes -MPC5554) (12 Kbytes -MPC5553)                     |
| Base + 0x1_4000- Base + 0x1_FFFF | Not writable Reads the return value of ETPU_SCMOFFDATAR register. |

1 Parameter Sign Extension access area. See the eTPU reference manual.

## 18.4.2 Register Description

Table 18-6 shows the eTPU registers and their locations, without examples or explanation of how the fields are used. For a complete description of these registers users should refer to the Enhanced Time Processing Unit (eTPU) Reference Manual . The features are explained in detail there.

Table 18-6. Detailed Memory Map

| Address                          | Register Name    | Register Description                             | Size (bits)   |
|----------------------------------|------------------|--------------------------------------------------|---------------|
| Base (0xC3FC_0000)               | ETPU_MCR         | eTPU module configuration register               | 32            |
| Base + 0x0_0004                  | ETPU_CDCR        | eTPU coherent dual-parameter controller register | 32            |
| Base + 0x0_0008                  | -                | Reserved                                         | -             |
| Base + 0x0_000C                  | ETPU_MISCCMPR    | eTPU MISC compare register                       | 32            |
| Base + 0x0_0010                  | ETPU_SCMOFFDATAR | eTPU SCM off-range data register                 | 32            |
| Base + 0x0_0014                  | ETPU_ECR_A       | eTPU A engine configuration register             | 32            |
| Base + 0x0_0018                  | ETPU_ECR_B 1     | eTPU B engine configuration register             | 32            |
| Base + 0x0_001C                  | -                | Reserved                                         | -             |
| Base + 0x0_0020                  | ETPU_TBCR_A      | eTPU A time base configuration register          | 32            |
| Base + 0x0_0024                  | ETPU_TB1R_A      | eTPU A time base 1                               | 32            |
| Base + 0x0_0028                  | ETPU_TB2R_A      | eTPU A time base 2                               | 32            |
| Base + 0x0_002C                  | ETPU_REDCR_A     | eTPU A STAC bus interface configuration register | 32            |
| Base + 0x0_0030- Base + 0x0_003F | -                | Reserved                                         | -             |

MPC5553/MPC5554 Microcontroller Reference Manual, Rev. 3.1

## Table 18-6. Detailed Memory Map (continued)

| Address                          | Register Name    | Register Description                                          | Size (bits)   |
|----------------------------------|------------------|---------------------------------------------------------------|---------------|
| Base + 0x0_0040                  | ETPU_TBCR_B 1    | eTPU B time base configuration register                       | 32            |
| Base + 0x0_0044                  | ETPU_TB1R_B 1    | eTPU B time base 1                                            | 32            |
| Base + 0x0_0048                  | ETPU_TB2R_B 1    | eTPU B time base 2                                            | 32            |
| Base + 0x0_004C                  | ETPU_REDCR_B 1   | eTPU B STAC bus interface configuration register              | 32            |
| Base + 0x0_0050- Base + 0x0_01FF | -                | Reserved                                                      | -             |
| Base + 0x0_0200                  | ETPU_CISR_A      | eTPU A channel interrupt status register                      | 32            |
| Base + 0x0_0204                  | ETPU_CISR_B 1    | eTPU B channel interrupt status register                      | 32            |
| Base + 0x0_0208                  | -                | Reserved                                                      | -             |
| Base + 0x0_020C                  | -                | Reserved                                                      | -             |
| Base + 0x0_0210                  | ETPU_CDTRSR_A    | eTPU A channel data transfer request status register          | 32            |
| Base + 0x0_0214                  | ETPU_CDTRSR_B 1  | eTPU B channel data transfer request status register          | 32            |
| Base + 0x0_0218                  | -                | Reserved                                                      | -             |
| Base + 0x0_021C                  | -                | Reserved                                                      | -             |
| Base + 0x0_0220                  | ETPU_CIOSR_A     | eTPU A channel interrupt overflow status register             | 32            |
| Base + 0x0_0224                  | ETPU_CIOSR_B 1   | eTPU B channel interrupt overflow status register             | 32            |
| Base + 0x0_0228                  | -                | Reserved                                                      | -             |
| Base + 0x0_022C                  | -                | Reserved                                                      | -             |
| Base + 0x0_0230                  | ETPU_CDTROSR_A   | eTPU A channel data transfer request overflow status register | 32            |
| Base + 0x0_0234                  | ETPU_CDTROSR_B 1 | eTPU B channel data transfer request overflow status register | 32            |
| Base + 0x0_0238                  | -                | Reserved                                                      | -             |
| Base + 0x0_023C                  | -                | Reserved                                                      | -             |
| Base + 0x0_0240                  | ETPU_CIER_A      | eTPU A channel interrupt enable register                      | 32            |
| Base + 0x0_0244                  | ETPU_CIER_B 1    | eTPU B channel interrupt enable register                      | 32            |
| Base + 0x0_0248                  | -                | Reserved                                                      | -             |
| Base + 0x0_024C                  | -                | Reserved                                                      | -             |
| Base + 0x0_0250                  | ETPU_CDTRER_A    | eTPU A channel data transfer request enable register          | 32            |
| Base + 0x0_0254                  | ETPU_CDTRER_B 1  | eTPU B channel data transfer request enable register          | 32            |
| Base + 0x0_0258- Base + 0x0_027F | -                | Reserved                                                      | -             |
| Base + 0x0_0280                  | ETPU_CPSSR_A     | eTPU A channel pending service status register                | 32            |
| Base + 0x0_0284                  | ETPU_CPSSR_B 1   | eTPU B channel pending service status register                | 32            |
| Base + 0x0_0288                  | -                | Reserved                                                      | -             |

## MPC5553/MPC5554 Microcontroller Reference Manual, Rev. 3.1

Table 18-6. Detailed Memory Map (continued)

| Address                          | Register Name   | Register Description                            | Size (bits)   |
|----------------------------------|-----------------|-------------------------------------------------|---------------|
| Base + 0x0_028C                  | -               | Reserved                                        | -             |
| Base + 0x0_0290                  | ETPU_CSSR_A     | eTPU A channel service status register          | 32            |
| Base + 0x0_0294                  | ETPU_CSSR_B 1   | eTPU B channel service status register          | 32            |
| Base + 0x0_0298- Base + 0x0_03FF | -               | Reserved                                        | -             |
| Base + 0x0_0400                  | ETPU_C0CR_A     | eTPU A channel 0 configuration register         | 32            |
| Base + 0x0_0404                  | ETPU_C0SCR_A    | eTPU A channel 0 status and control register    | 32            |
| Base + 0x0_0408                  | ETPU_C0HSRR_A   | eTPU A channel 0 host service request register  | 32            |
| Base + 0x0_040C                  | -               | Reserved                                        | -             |
| Base + 0x0_0410                  | ETPU_C1CR_A     | eTPU A channel 1 configuration register         | 32            |
| Base + 0x0_0414                  | ETPU_C1SCR_A    | eTPU A channel 1 status and control register    | 32            |
| Base + 0x0_0418                  | ETPU_C1HSRR_A   | eTPU A channel 1 host service request register  | 32            |
| Base + 0x0_041C                  | -               | Reserved                                        | -             |
| .                                | .               | .                                               | .             |
| .                                | .               | .                                               | .             |
| .                                | .               | .                                               | .             |
| Base + 0x0_05F0                  | ETPU_C31CR_A    | eTPU A channel 31 configuration register        | 32            |
| Base + 0x0_05F4                  | ETPU_C31SCR_A   | eTPU A channel 31 status and control register   | 32            |
| Base + 0x0_05F8 Base +           | ETPU_C31HSRR_A  | eTPU A channel 31 host service request register | 32            |
| 0x0_05FC- Base + 0x0_07FF        | -               | Reserved                                        | -             |
| Base + 0x0_0800                  | ETPU_C0CR_B 1   | eTPU B channel 0 configuration register         | 32            |
| Base + 0x0_0804                  | ETPU_C0SCR_B 1  | eTPU B channel 0 status and control register    | 32            |
| Base + 0x0_0808                  | ETPU_C0HSRR_B 1 | eTPU B channel 0 host service request register  | 32 -          |
| Base + 0x0_080C                  | -               | Reserved                                        |               |
| Base + 0x0_0814                  | ETPU_C1SCR_B 1  | eTPU B channel 1 status and control register    | 32            |
| Base + 0x0_0818                  | ETPU_C1HSRR_B 1 | eTPU B channel 1 host service request register  | 32            |
| Base + 0x0_081C                  | -               | Reserved                                        | -             |
| .                                | .               | .                                               | .             |
| .                                | .               | .                                               | .             |
| Base + 0x0_09F0                  | ETPU_C31CR_B 1  | .                                               | . 32          |
| .                                | .               | eTPU B channel 31 configuration register        |               |
| Base + 0x0_09F4                  | ETPU_C31SCR_B 1 | eTPU B channel 31 status and control register   | 32            |
| Base + 0x0_09F8                  | ETPU_C31HSRR_B  | eTPU B Channel 31 host service request          | 32            |
|                                  | 1               | register                                        |               |

## MPC5553/MPC5554 Microcontroller Reference Manual, Rev. 3.1

## Table 18-6. Detailed Memory Map (continued)

| Address                          | Register Name   | Register Description                        | Size (bits)                             |
|----------------------------------|-----------------|---------------------------------------------|-----------------------------------------|
| Base + 0x0_09FC- Base + 0x0_7FFF | -               | Reserved                                    | -                                       |
| Base + 0x0_8000- Base + 0x0_8BFF | -               | 3 Kbytes shared data memory (parameter RAM) | 3 Kbytes                                |
| Base + 0x0_8C00- Base + 0x0_BFFF | -               | Reserved                                    | -                                       |
| Base + 0x0_C000- Base + 0x0_CBFF | -               | 3 Kbytes SDM PSE mirror 2                   | 3 Kbytes                                |
| Base + 0x0_CC00- Base + 0x0_FFFF | -               | Reserved                                    | -                                       |
| Base + 0x1_0000- Base + 0x1_2FFF | SCM             | Shared code memory 3                        | 12 Kbytes (MPC5553) 16 Kbytes (MPC5554) |
| Base + 0x1_3000- Base + 0x1_FFFF | -               | Reserved                                    | -                                       |

- 1 The register at this address is available only on the MPC5554, not on the MPC5553.
- 2 Parameter sign extension access area. See the eTPU reference manual.
- 3 SCM access is only available under certain conditions when ETPU\_MCR[VIS] = 1. The SCM can only be written in 32-bit accesses.

## 18.4.2.1 System Configuration Registers

## 18.4.2.1.1 eTPU Module Configuration Register (ETPU\_MCR)

This register is global to both eTPU engines, and resides in the shared BIU. ETPU\_MCR gathers global configuration and status in the eTPU system, including global exception. It is also used for configuring the SCM (shared code memory) operation and test.

Figure 18-5. ETPU\_MCR Register

<!-- image -->

|          | 0               | 1               | 2               | 3               | 4               | 5               | 6               | 7               | 8               | 9               | 10              | 11              | 12              | 13              | 14              | 15              |
|----------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|
| R        | 0               | 0               | 0               | 0               | MGEA            | MGEB            | ILFA            | ILFB            | 0               | 0               | 0               | SCMSIZE         | SCMSIZE         | SCMSIZE         | SCMSIZE         | SCMSIZE         |
| W        | GEC             |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |
| Reset    | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               |                 | SCMSIZE         | SCMSIZE         | SCMSIZE         | SCMSIZE         |
| Reg Addr | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 |
|          | 16              | 17              | 18              | 19              | 20              | 21              | 22              | 23              | 24              | 25              | 26              | 27              | 28              | 29              | 30              | 31              |
| R        | 0               | 0               | 0               | 0               | 0               | SCMMISF         | SCMMISEN        | 0               | 0               | VIS             | 0               | 0               | 0               | 0               | 0               | GTBE            |
| W        |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |
| Reset    | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               |
| Reg Addr | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 | Base + 0x0_0000 |

## MPC5553/MPC5554 Microcontroller Reference Manual, Rev. 3.1

## Table 18-7. ETPU\_MCR Bit Field Descriptions

| Bits   | Name          | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|--------|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0      | GEC           | Global exception clear. Negates global exception request and clears global exception status bits MGEA, MGEB, ILFA, ILFB and SCMMISF. A read will always return 0. Writes have the following effect: 0 Keep global exception request and status bits ILFA, ILFB, MGEA, MGEB, and SCMMISF as is. 1 Negate global exception, clear status bits ILFA, ILFB, MGEA, MGEB, and SCMMISF. GEC works the same way with either one or both engines in stop mode.                                                                                                 |
| 1-3    | -             | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 4      | MGEA          | Microcode global exception engine A. Indicates that a global exception was asserted by microcode executed on the respective engine. The determination of the reason why the global exception was asserted is application dependent: it can be coded in an SDMstatus parameter, for instance. This bit is cleared by writing 1 to GEC. 0 No microcode-requested global exception pending. 1 Global exception requested by microcode is pending.                                                                                                        |
| 5      | MGEB          | Microcode global exception engine B. Indicates that a global exception was asserted by microcode executed on the respective engine. The determination of the reason why the global exception was asserted is application dependent: it can be coded in an SDMstatus parameter, for instance. This bit is cleared by writing 1 to GEC. 0 No microcode requested global exception pending. 1 Global exception requested by microcode is pending.                                                                                                        |
| 6      | ILFA          | Illegal instruction flag eTPU A. Set by the microengine to indicate that an illegal instruction was decoded in engine A. This bit is cleared by host writing 1 to GEC. For more information about illegal instructions, see Section 9.6 in the eTPU reference manual. 0 Illegal Instruction not detected. 1 Illegal Instruction detected by eTPU A.                                                                                                                                                                                                   |
| 7      | ILFB          | Illegal instruction flag eTPU B. Set by the microengine to indicate that an illegal instruction was decoded in engine B. This bit is cleared by host writing 1 to GEC. For more details, refer to the eTPU reference manual. 0 Illegal Instruction not detected. 1 Illegal Instruction detected by eTPU B.                                                                                                                                                                                                                                            |
| 8-10   | -             | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 11-15  | SCMSIZE [0:4] | SCM size. Holds the number of 2 Kbyte SCM Blocks minus 1. This value is MCU-dependent.                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 16-20  | -             | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 21     | SCMMISF       | SCM MISC Flag. Set by the SCM MISC (multiple input signature calculator) logic to indicate that the calculated signature does not match the expected value, at the end of a MISC iteration. For more details, refer to the eTPU reference manual for more details. 0 Signature mismatch not detected. 1 MISC has read entire SCM array and the expected signature in ETPU_MISCCMPR does not match the value calculated. This bit is automatically cleared when SCMMISEN changes from 0 to 1, or when global exception is cleared by writing 1 to GEC. |

## Table 18-7. ETPU\_MCR Bit Field Descriptions (continued)

| Bits    | Name     | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|---------|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 22      | SCMMISEN | SCM MISC enable. Used for enabling/disabling the operation of the MISC logic. SCMMISEN is readable and writable at any time. The MISC logic will only operate when this bit is set to 1. When the bit is reset the MISC address counter is set to the initial SCM address. When enabled, the MISC will continuously cycle through the SCM addresses, reading each and calculating a CRC. In order to save power, the MISC can be disabled by clearing the SCMMISEN bit. For more details, refer to the eTPU reference manual. 0 MISC operation disabled. The MISC logic is reset to its initial state. 1 MISC operation enabled. (Toggling to 1 clears the SCMMISF bit) SCMMISEN is cleared automatically when MISC logic detects an error; that is, when SCMMISF transitions from 0 to 1, disabling the MISC operation. |
| 23 - 24 | -        | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 25      | VIS      | SCM visibility. Determines SCM visibility to the slave bus interface and resets the MISC state (but SCMMISEN keeps its value). 0 SCM is not visible to the slave bus. Accessing SCM address space issues a bus error. 1 SCM is visible to the slave bus. The MISC state is reset. This bit is write protected when any of the engines are not in halt or stop states. When VIS=1, the ETPU_ECR MDIS bits are write protected, and only 32-bit aligned SCM writes are supported. The value written to SCM is unpredictable if other transfer sizes are used.                                                                                                                                                                                                                                                              |
| 26 - 30 | -        | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 31      | GTBE     | Global time base enable. Enables time bases in both engines, allowing them to be started synchronously. An assertion of GTBE also starts the eMIOS time base 1 . This enables the eTPU time bases and the eMIOS time base to all start synchronously. 1 time bases in both eTPU engines and eMIOS are enabled to run. 0 time bases in both engines are disabled to run. Note: When GTBE is turned off with Angle Mode enabled, the EAC must be reinitialized before GTBE is turned on again.                                                                                                                                                                                                                                                                                                                             |

1 The eMIOS also has an GTBE bit. Assertion of either the eMIOS or eTPU GTBE bit starts time bases for the eMIOS and eTPU, see the eTPU reference manual.

## 18.4.2.1.2 eTPU Coherent Dual-Parameter Controller Register (ETPU\_CDCR)

ETPU\_CDCR configures and controls dual-parameter coherent transfers. For more information, refer to the eTPU reference manual.

Figure 18-6. eTPU Coherent Dual-Parameter Controller Register (ETPU\_CDCR)

<!-- image -->

## Table 18-8. ETPU\_CDCR Field Descriptions

| Bits   | Name         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|--------|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0      | STS          | Start. Set by the host in order to start the data transfer between the parameter buffer pointed by PBBASE and the target addresses selected by the concatenation of fields CTBASE and PARM0/1. The host receives wait-states until the data transfer is complete. Coherency logic resets STSonce the data transfer is complete. For more information, refer to the eTPU reference manual. 0 (Write) does not start a coherent transfer. 1 (Write) starts a coherent transfer. |
| 1-5    | CTBASE [0:4] | Channel transfer base. This field concatenates with fields PARM0/PARM1to determine the absolute offset (from the SDM base) of the parameters to be transferred: Parameter 0 address = {CTBASE, PARM0} × 4 + SDM base Parameter 1 address = {CTBASE, PARM1} × 4 + SDM base                                                                                                                                                                                                     |
| 6-15   | PBBASE [0:9] | Parameter buffer base address. Points to the base address of the parameter buffer location, with granularity of 2 parameters (8 bytes). The host (byte) address of the first parameter in the buffer is PBBASE × 8 + SDM Base Address.                                                                                                                                                                                                                                        |
| 16     | PWIDTH       | Parameter width selection. Selects the width of the parameters to be transferred between the PB and the target address. 0 Transfer 24-bit parameters. The upper byte remains unchanged in the destination address. 1 Transfer 32-bit parameters. All 32 bits of the parameters are written in the destination address.                                                                                                                                                        |
| 17-23  | PARM0 [0:6]  | Channel parameter number 0. This field in concatenation with CTBASE[3:0] determine the address offset (from the SDM base address) of the parameter which is the destination or source (defined by WR)of the coherent transfer. The SDMaddress offset of the parameter is {CTBASE, PARM0}*4.Note that PARM0 allows non-contiguous parameters to be transferred coherently 1 .                                                                                                  |

Table 18-8. ETPU\_CDCR Field Descriptions (continued)

| Bits    | Name        | Description                                                                                                                                                                                                                                                                                                                                                            |
|---------|-------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 24      | WR          | Read/Write selection. This bit selects the direction of the coherent data transfer. 0 Read operation. Data transfer is from the selected parameter RAM address to the PB. 1 Write operation. Data transfer is from the PB to the selected parameter RAM address.                                                                                                       |
| 25 - 31 | PARM1 [0:6] | Channel parameter number 1. This field in concatenation with CTBASE[3:0] determines the address offset (from the SDMbase) of the parameter which is the destination or source (defined by WR) of the coherent transfer. The SDM address offset of the parameter is {CTBASE, PARM1}*4.Note that PARM1 allows non-contiguous parameters to be transferred coherently 1 . |

1 The parameter pointed by {CTBASE, PARM0} is the first transferred.

## 18.4.2.1.3 eTPU MISC Compare Register (ETPU\_MISCCMPR)

The multiple input signature calculator compare register (ETPU\_MISCCMPR) holds the 32-bit signature expected from the whole shared code memory (SCM) array. This register must be written by the host with the 32-bit word to be compared against the calculated signature at the end of the MISC cycle. This register is global to both eTPU engines. For more details, refer to the eTPU reference manual.

Figure 18-7. eTPU MISC Compare Register (ETPU\_MISCCMPR)

<!-- image -->

|          | 0               | 1               | 2               | 3               | 4               | 5               | 6               | 7               | 8               | 9               | 10              | 11              | 12              | 13              | 14              | 15              |
|----------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|
| R        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        |
| W        |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |
| Reset    | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               |
| Reg Addr | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C |
|          | 16              | 17              | 18              | 19              | 20              | 21              | 22              | 23              | 24              | 25              | 26              | 27              | 28              | 29              | 30              | 31              |
| R        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        | EMISCCMP        |
| W        |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |                 |
| Reset    | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               |
| Reg Addr | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C | Base + 0x0_000C |

Table 18-9. ETPU\_MISCCMPR Field Descriptions

| Bits   | Name            | Description                                                                                                                    |
|--------|-----------------|--------------------------------------------------------------------------------------------------------------------------------|
| 0 - 31 | EMISCCM P[0:31] | Expected multiple input signature calculator compare register value. For more information, refer to the eTPU reference manual. |

## 18.4.2.1.4 eTPU SCM Off-Range Data Register (ETPU\_SCMOFFDATAR)

ETPU\_SCMOFFDATAR  holds  the  32-bit  value  returned  when  the  SCM  array  is  accessed  at  non implemented addresses, either by the host or by the microengine. This register can be written by the host with the 32-bit instruction to be executed by the microengine to recover from runaway code. This register is global to both ETPU engines.

Figure 18-8. eTPU SCM Off-Range Data Register (ETPU\_SCMOFFDATAR)

<!-- image -->

|          | 0                     | 1                     | 2                     | 3                     | 4                     | 5                     | 6                     | 7                     | 8                     | 9                     | 10                    | 11                    | 12                    | 13                    | 14                    | 15                    |
|----------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|
| R        | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  | ETPUSCMOFFDATA[0:15]  |
| W Reset  | 1                     | 1                     | 1                     | 1                     | 0                     | 0                     | 1                     | 1                     | 0                     | 1                     | 1                     | 1                     | 0                     | 1                     | 1                     | 1                     |
| Reg Addr | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       |
|          | 16                    | 17                    | 18                    | 19                    | 20                    | 21                    | 22                    | 23                    | 24                    | 25                    | 26                    | 27                    | 28                    | 29                    | 30                    | 31                    |
| R        | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] | ETPUSCMOFFDATA[16:31] |
| W        |                       |                       |                       |                       |                       |                       |                       |                       |                       |                       |                       |                       |                       |                       |                       |                       |
| Reset    | 0                     | 1                     | 0                     | 1                     | 1                     | 1                     | 1                     | 1                     | 1                     | 1                     | 1                     | 1                     | 1                     | 0                     | 1                     | 1                     |
| Reg Addr | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       | Base + 0x0_0010       |

## Table 18-10. ETPU\_SCMOFFDATAR Field Descriptions

| Bits   | Name            | Description                    |
|--------|-----------------|--------------------------------|
| 0 - 31 | ETPUSCMOFFDATAR | SCM Off-range read data value. |

## 18.4.2.1.5 eTPU Engine Configuration Register (ETPU\_ECR)

Each engine has its  own  ETPU\_ECR. The ETPU\_ECR holds configuration and status fields that are programmed independently in each engine.

Figure 18-9. eTPU Engine Configuration Register (ETPU\_ECR)

<!-- image -->

Table 18-11.  ETPU\_ECR Field Descriptions

| Bits   | Name   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|--------|--------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0      | FEND   | Force end. Assertion terminates any current running thread as if an END instruction have been executed. For more information, refer to the eTPU reference manual. 0 Normal operation. 1 Terminates current thread. This bit is self-negating.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 1      | MDIS   | Module disable internal stop. This is the low power stop bit. When MDIS is set, the engine shuts down its internal clocks. TCR1 and TCR2 cease to increment, and input sampling stops. The engine asserts the stop flag (STF) bit to indicate that it has stopped. However, the BIU continues to run, and the host can access all registers except for the channel registers 1 and writes to time base registers. More information on channel registers may be found in Section 18.4.2.4, 'Channel Configuration and Control Registers.' After MDIS is set, even before STFasserts, data read from the channel registers is not meaningful, a Bus Error is issued, and writes are unpredictable. When the MDIS bit is asserted while the microcode is executing, the eTPU will stop when the thread is complete. 0 eTPU engine runs. 1 Commands engine to stop its clocks. Stop completes on the next system clock after the stop condition is valid. The MDIS bit is write-protected when ETPU_MCR[VIS]=1. Note: Once MDIS has been switched from 1 to 0 or vice-versa, do not switch its value again until STF is written to. |
| 2      | -      | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 3      | STF    | Stop flag bit. Each engine asserts its stop flag (STF) to indicate that it has stopped. Only then the host can assume that the engine has actually stopped. The eTPU system is fully stopped when the STF bits of both eTPU engines are asserted. The engine only stops when any ongoing thread is complete in this case. 0 The engine is operating. 1 The engine has stopped (after the local MDIS bit has been asserted, or after the STAC bus stop line has been asserted). Summarizing engine stop conditions, which STF reflects: STF_A := (after stop completed) MDIS_A STF_B := (after stop completed) MDIS_B STF_A and STF_B mean STF bit from engine A and STF bit from engine B respectively.                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 4-7    | -      | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 8      | HLTF   | Halt mode flag. If eTPU engine entered halt state, this flag is asserted. The flag remains asserted while the microengine is in halt state, even during a single-step or forced instruction execution. Refer to the eTPUreference manual for further details about entering halt mode. 0 eTPU engine is not halted. 1 eTPU engine is halted                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 9-12   | -      | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

Table 18-11.  ETPU\_ECR Field Descriptions (continued)

| Bits   | Name        | Description                                                                                                                                                                                                                                                                                                                                                                                   | Description                                                                                                                                                                                                                                                                                                                                                                                   | Description                                                                                                                                                                                                                                                                                                                                                                                   |
|--------|-------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 13-15  | FPSCK [0:2] | Filter prescaler clock control. Controls the prescaling of the clocks used in digital filters for the channel input signals and TCRCLK input. The following table illustrates filter prescaler clock control.                                                                                                                                                                                 | Filter prescaler clock control. Controls the prescaling of the clocks used in digital filters for the channel input signals and TCRCLK input. The following table illustrates filter prescaler clock control.                                                                                                                                                                                 | Filter prescaler clock control. Controls the prescaling of the clocks used in digital filters for the channel input signals and TCRCLK input. The following table illustrates filter prescaler clock control.                                                                                                                                                                                 |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                               |
|        |             | Filtering can be controlled independently by the engine, but all input digital filters in the same engine have same clock prescaling. For more details, refer to the eTPU reference manual.                                                                                                                                                                                                   | Filtering can be controlled independently by the engine, but all input digital filters in the same engine have same clock prescaling. For more details, refer to the eTPU reference manual.                                                                                                                                                                                                   | Filtering can be controlled independently by the engine, but all input digital filters in the same engine have same clock prescaling. For more details, refer to the eTPU reference manual.                                                                                                                                                                                                   |
| 16-17  | CDFC [0:1]  | Channel digital filter control. Select a digital filtering mode for the channels when configured as inputs for improved noise immunity. Channel digital filter control is illustrated in the following table.                                                                                                                                                                                 | Channel digital filter control. Select a digital filtering mode for the channels when configured as inputs for improved noise immunity. Channel digital filter control is illustrated in the following table.                                                                                                                                                                                 | Channel digital filter control. Select a digital filtering mode for the channels when configured as inputs for improved noise immunity. Channel digital filter control is illustrated in the following table.                                                                                                                                                                                 |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               | CDFC                                                                                                                                                                                                                                                                                                                                                                                          | Selected Digital Filter                                                                                                                                                                                                                                                                                                                                                                       |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               | 00                                                                                                                                                                                                                                                                                                                                                                                            | TPU2/3 two sample mode: Using the filter clock which is the system clock divided by (2, 4, 8,..., 256) as a sampling clock (selected by FPSCK field in ETPU_ECR), comparing two consecutive samples which agree with each other sets the input signal state. This is the default reset state.                                                                                                 |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               | 01                                                                                                                                                                                                                                                                                                                                                                                            | Reserved.                                                                                                                                                                                                                                                                                                                                                                                     |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               | 10                                                                                                                                                                                                                                                                                                                                                                                            | eTPU three sample mode: Similar to the TPU2/3 two sample mode, but comparing three consecutive samples which agree with each other sets the input signal state.                                                                                                                                                                                                                               |
|        |             |                                                                                                                                                                                                                                                                                                                                                                                               | 11                                                                                                                                                                                                                                                                                                                                                                                            | eTPU continuous mode: Signal needs to be stable for the whole filter clock period. This mode compares all the values at the rate of system clock divided by two, between two consecutive filter clock pulses. If all the values agree with each other, input signal state is updated.                                                                                                         |
|        |             | The eTPU has three digital filtering modes for the channels which provide programmable trade-off between signal latency and noise immunity. For more information on filtering, refer to the eTPU reference manual. Changing CDFC during eTPU normal input channel operation is not recommended since it changes the behavior of the transition detection logic while executing its operation. | The eTPU has three digital filtering modes for the channels which provide programmable trade-off between signal latency and noise immunity. For more information on filtering, refer to the eTPU reference manual. Changing CDFC during eTPU normal input channel operation is not recommended since it changes the behavior of the transition detection logic while executing its operation. | The eTPU has three digital filtering modes for the channels which provide programmable trade-off between signal latency and noise immunity. For more information on filtering, refer to the eTPU reference manual. Changing CDFC during eTPU normal input channel operation is not recommended since it changes the behavior of the transition detection logic while executing its operation. |

Table 18-11.  ETPU\_ECR Field Descriptions (continued)

| Bits   | Name      | Description                                                                                                                                                                                                                                        | Description                                                                                                                                                                                                                                        |
|--------|-----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 18-26  | -         | Reserved.                                                                                                                                                                                                                                          | Reserved.                                                                                                                                                                                                                                          |
| 27-31  | ETB [0:4] | Entry table base. Determines the location of the microcode entry table for the eTPU functions in SCM. More information about entry points is located in the eTPU reference manual. The following table shows the entry table base address options. | Entry table base. Determines the location of the microcode entry table for the eTPU functions in SCM. More information about entry points is located in the eTPU reference manual. The following table shows the entry table base address options. |
|        |           |                                                                                                                                                                                                                                                    | ETB                                                                                                                                                                                                                                                |
|        |           |                                                                                                                                                                                                                                                    | 00000                                                                                                                                                                                                                                              |
|        |           |                                                                                                                                                                                                                                                    | 00001                                                                                                                                                                                                                                              |
|        |           |                                                                                                                                                                                                                                                    | 00010                                                                                                                                                                                                                                              |
|        |           |                                                                                                                                                                                                                                                    | . . .                                                                                                                                                                                                                                              |
|        |           |                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                    |
|        |           |                                                                                                                                                                                                                                                    | .                                                                                                                                                                                                                                                  |
|        |           |                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                    |
|        |           |                                                                                                                                                                                                                                                    | 11110                                                                                                                                                                                                                                              |
|        |           |                                                                                                                                                                                                                                                    | 11111                                                                                                                                                                                                                                              |

1 The time base registers can still be read in stop mode, but writes are ineffective and a bus error is issued. Global channel registers and SDM can be accessed normally.

## 18.4.2.2 Time Base Registers

Time base registers allow the configuration and visibility of internally-generated time bases TCR1 and TCR2. There is one of each of these registers for each eTPU engine.

## NOTE

Writes to this register issue a bus error and are ineffective when MDIS=1. Reads are always allowed.

## 18.4.2.2.1 eTPU Time Base Configuration Register (ETPU\_TBCR)

This register configures several time base options.

Figure 18-10. eTPU Time Base Configuration Register (ETPU\_TBCR)

<!-- image -->

## NOTE

The MPC5554 has two eTPU engines, where the MPC5553 only has one. So for MPC5554, there are 2 TCRCLK signals, one for each eTPU engine: TCRCLKA and TCRCLKB

## Table 18-12.  ETPU\_TBCR Field Descriptions

| Bits   | Name    | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|--------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0-2    | TCR2CTL | TCR2 clock/gate control. Part of the TCR2 clocking system. These bits determine the clock source for TCR2 before the prescaler. TCR2 can count on any detected edge of the TCRCLK signal or use it for gating system clock divided by 8. After reset, TCRCLK signal rising edge is selected. TCR2 can also be clocked by an internal peripheral timebase signal or the system clock divided by 8. TCR2CTL also determines the TCRCLK edge selected for angle tooth detection in angle mode. Refer to the eTPU User's Manual for more information. TCR2 clock sources are listed in the following table. | TCR2 clock/gate control. Part of the TCR2 clocking system. These bits determine the clock source for TCR2 before the prescaler. TCR2 can count on any detected edge of the TCRCLK signal or use it for gating system clock divided by 8. After reset, TCRCLK signal rising edge is selected. TCR2 can also be clocked by an internal peripheral timebase signal or the system clock divided by 8. TCR2CTL also determines the TCRCLK edge selected for angle tooth detection in angle mode. Refer to the eTPU User's Manual for more information. TCR2 clock sources are listed in the following table. | TCR2 clock/gate control. Part of the TCR2 clocking system. These bits determine the clock source for TCR2 before the prescaler. TCR2 can count on any detected edge of the TCRCLK signal or use it for gating system clock divided by 8. After reset, TCRCLK signal rising edge is selected. TCR2 can also be clocked by an internal peripheral timebase signal or the system clock divided by 8. TCR2CTL also determines the TCRCLK edge selected for angle tooth detection in angle mode. Refer to the eTPU User's Manual for more information. TCR2 clock sources are listed in the following table. |
| 0-2    | TCR2CTL | TCR2CTL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | AM=0 (TCR2 Clock)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | AM=1 (Angle Tooth Detection)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 0-2    | TCR2CTL | 000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Gated DIV8 clock (system clock / 8). When the external TCRCLK signal is low, the DIV8 clock is blocked, preventing it from incrementing the TCR2 prescaler. When the external TCRCLK signal is high, TCR2 prescaler is incremented at the frequency of the system clock divided by 8.                                                                                                                                                                                                                                                                                                                   | See Note 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 0-2    | TCR2CTL | 001                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Rise transition on TCRCLK signal increments TCR2 prescaler.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Rising Edge                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 0-2    | TCR2CTL | 010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Fall transition on TCRCLK signal increments TCR2 prescaler.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Falling Edge                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 0-2    | TCR2CTL | 011                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Rise or fall transition on TCRCLK signal increments TCR2 prescaler.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Rising or Falling Edge                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 0-2    | TCR2CTL | 100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | DIV8 clock (system clock / 8)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | See Note 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 0-2    | TCR2CTL | 101                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Peripheral Timebase clock source                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | See Note 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 0-2    | TCR2CTL | 110                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Reserved                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | See Note 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 0-2    | TCR2CTL | 111                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | TCR2CTLshuts down TCR2clocking, except on Angle Mode. TCR2 can also change as STAC client.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | See Note 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 0-2    | TCR2CTL | 1 These selections must not be used with AM=1 (Angle Mode).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 1 These selections must not be used with AM=1 (Angle Mode).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 1 These selections must not be used with AM=1 (Angle Mode).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |

## Table 18-12.  ETPU\_TBCR Field Descriptions (continued)

| Bits   | Name   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|--------|--------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 3-4    | TCRCF  | TCRCLKsignal filter control. Controls the TCRCLKdigital filter determining whether the TCRCLK signal input (after a synchronizer) is filtered with the same filter clock as the channel input signals or uses the system clock divided by 2, and also whether the TCRCLK digital filter works in integrator mode or two sample mode. The following table describes TCRCLK filter clock/mode.                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | TCRCLKsignal filter control. Controls the TCRCLKdigital filter determining whether the TCRCLK signal input (after a synchronizer) is filtered with the same filter clock as the channel input signals or uses the system clock divided by 2, and also whether the TCRCLK digital filter works in integrator mode or two sample mode. The following table describes TCRCLK filter clock/mode.                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 3-4    | TCRCF  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | TCRCF                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 3-4    | TCRCF  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | 00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 3-4    | TCRCF  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | 01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 3-4    | TCRCF  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | 10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 3-4    | TCRCF  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | 11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 3-4    | TCRCF  | For more information, refer to the eTPU User's Manual.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | For more information, refer to the eTPU User's Manual.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 5      | -      | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 6      | AM     | Angle mode selection. When the AMbit is set (MPC5554: and neither TCR1 nor TCR2 are STAC interface clients), the EAC (eTPU Angle Clock) hardware provides angle information to the channels using the TCR2 bus. When the AM bit is cleared (non-angle mode), EAC operation is disabled, and its internal registers can be used as general purpose registers. 0 EAC operation is disabled. 1 TCR2 works in angle mode; (MPC5554: if TCR2 is not a STAC client, the EAC works and stores tooth counter and angle tick counter data in TCR2.) (MPC5554: If TCR1 or TCR2 is a STAC bus client, EAC operation is forbidden. Therefore, if AM is set, the angle logic will not work properly.) Note: AM must not be changed when ETPU_MCR[GTBE] = 1. Note: Changing AM may cause expurious transition detections on channel 0, depending on the channel mode and state. | Angle mode selection. When the AMbit is set (MPC5554: and neither TCR1 nor TCR2 are STAC interface clients), the EAC (eTPU Angle Clock) hardware provides angle information to the channels using the TCR2 bus. When the AM bit is cleared (non-angle mode), EAC operation is disabled, and its internal registers can be used as general purpose registers. 0 EAC operation is disabled. 1 TCR2 works in angle mode; (MPC5554: if TCR2 is not a STAC client, the EAC works and stores tooth counter and angle tick counter data in TCR2.) (MPC5554: If TCR1 or TCR2 is a STAC bus client, EAC operation is forbidden. Therefore, if AM is set, the angle logic will not work properly.) Note: AM must not be changed when ETPU_MCR[GTBE] = 1. Note: Changing AM may cause expurious transition detections on channel 0, depending on the channel mode and state. |
| 7-9    | -      | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 10-15  | TCR2P  | Timer count register 2 prescaler control. Part of the TCR2 clocking system. TCR2 is clocked from the output of a prescaler. The prescaler divides its input by (TCR2P+1) allowing frequency divisions from 1 to 64. The prescaler input is the system clock divided by 8 (in gated or non-gated clock mode) or Internal Timebase input, or TCRCLK filtered input. This field has no effect on                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Timer count register 2 prescaler control. Part of the TCR2 clocking system. TCR2 is clocked from the output of a prescaler. The prescaler divides its input by (TCR2P+1) allowing frequency divisions from 1 to 64. The prescaler input is the system clock divided by 8 (in gated or non-gated clock mode) or Internal Timebase input, or TCRCLK filtered input. This field has no effect on                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

Table 18-12.  ETPU\_TBCR Field Descriptions (continued)

| Bits   | Name    | Description                                                                                                                                                                                                                                                                                                            |
|--------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 16-23  | TCR1CTL | TCR1 clock/gate control. Part of the TCR1 clocking system. It determines the clock source for TCR1. TCR1cancount on detected rising edge of the TCRCLKsignal or the system clock divided by 2. After reset TCRCLK signal is selected. The following table shows the selection of the TCR1 clock source.                |
| 16-23  | TCR1CTL |                                                                                                                                                                                                                                                                                                                        |
| 16-23  | TCR1CTL |                                                                                                                                                                                                                                                                                                                        |
| 16-23  | TCR1CTL |                                                                                                                                                                                                                                                                                                                        |
| 16-23  | TCR1CTL |                                                                                                                                                                                                                                                                                                                        |
| 16-23  | TCR1CTL |                                                                                                                                                                                                                                                                                                                        |
| 16-23  | TCR1CTL | For more information on the TCR1 clocking system, refer to the eTPU User's Manual.                                                                                                                                                                                                                                     |
| 24-31  | TCR1P   | Timer count register 1 prescaler control. Clocked from the output of a prescaler. The input to the prescaler is the internal eTPU system clock divided by 2 or the output of TCRCLK filter, or Peripheral Timebase input. The prescaler divides this input by (TCR1P+1) allowing frequency divisions from 1 up to 256. |

## 18.4.2.2.2 eTPU Time Base 1 (TCR1) Visibility Register (ETPU\_TB1R )

This register provides visibility of the TCR1 time base for core host read access. This register is read-only. The value of the TCR1 time base shown can be driven by the TCR1 counter or imported, depending on the configuration set in ETPU\_REDCR. For more information, refer to the eTPU reference manual.

Figure 18-11. eTPU Time Base 1 (TCR1) Visibility Register (ETPU\_TB1R)

|          | 0                                         | 1                                         | 2                                         | 3                                         | 4                                         | 5                                         | 6                                         | 7                                         | 8                                         | 9                                         | 10                                        | 11                                        | 12                                        | 13                                        | 14                                        | 15                                        |
|----------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|-------------------------------------------|
| R        | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      |
| W        |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |
| Reset    | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         |
| Reg Addr | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      | + 0x0_0024 / eTPU B: Base + 0x0_0044      |
|          | 16                                        | 17                                        | 18                                        | 19                                        | 20                                        | 21                                        | 22                                        | 23                                        | 24                                        | 25                                        | 26                                        | 27                                        | 28                                        | 29                                        | 30                                        | 31                                        |
| R        | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      | TCR1                                      |
| W        |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |                                           |
| Reset    | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         | 0                                         |
| Reg Addr | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 | Base + 0x0_0024 / eTPU B: Base + 0x0_0044 |

Table 18-13.  ETPU\_TB1R Field Descriptions

| Bits   | Name        | Description                                                                                    |
|--------|-------------|------------------------------------------------------------------------------------------------|
| 0-7    | -           | Reserved.                                                                                      |
| 8-31   | TCR1 [0:23] | TCR1 value. Used on matches and captures. For more information, see the eTPU reference manual. |

## 18.4.2.2.3 eTPU Time Base 2 (TCR2) Visibility Register (ETPU\_TB2R)

This register provides visibility of the TCR2 time base for core host read access. This register is read-only. The value of the TCR2 time base shown can be driven by the TCR2 counter, the angle mode logic, or imported from the STAC interface, depending on angle mode (an engine cannot import when in angle mode) and STAC interface configurations set in registers ETPU\_TBCR and ETPU\_REDCR. For more information on time bases, refer to the eTPU reference manual.

Figure 18-12. eTPU Time Base 2 (TCR2) Visibility Register (ETPU\_TB2R)

<!-- image -->

|          | 0                                                 | 1                                                 | 2                                                 | 3                                                 | 4                                                 | 5                                                 | 6                                                 | 7                                                 | 8                                                 | 9                                                 | 10                                                | 11                                                | 12                                                | 13                                                | 14                                                | 15                                                |
|----------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|
| R        | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              |
| W        |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 | eTPU A: BASE + 0x0_0028 / eTPU B: BASE + 0x0_0048 |
|          | 16                                                | 17                                                | 18                                                | 19                                                | 20                                                | 21                                                | 22                                                | 23                                                | 24                                                | 25                                                | 26                                                | 27                                                | 28                                                | 29                                                | 30                                                | 31                                                |
| R        | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              | TCR2                                              |
| W        |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              | + 0x0_0028 / eTPU B: BASE + 0x0_0048              |

Table 18-14.  ETPU\_TB2R Bit Field Descriptions

| Bits   | Name        | Description                                                                                            |
|--------|-------------|--------------------------------------------------------------------------------------------------------|
| 0-7    | -           | Reserved.                                                                                              |
| 8-31   | TCR2 [0:23] | TCR2 value. Used on matches and captures. For information on TCR2, refer to the eTPU reference manual. |

## 18.4.2.2.4 STAC Bus Configuration Register (ETPU\_REDCR)

This register configures the eTPU STAC bus interface module and operation. For more information on the STAC interface, refer to the eTPU reference manual.

Figure 18-13. STAC Bus Configuration Register (ETPU\_REDCR)

<!-- image -->

|          | 0                                                 | 1                                                 | 2                                                 | 3                                                 | 4                                                 | 5                                                 | 6                                                 | 7                                                 | 8                                                 | 9                                                 | 10                                                | 11                                                | 12                                                | 13                                                | 14                                                | 15                                                |
|----------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|
| R        | REN1                                              | RSC1                                              | 0                                                 | 0                                                 | SERVER_ID1                                        | SERVER_ID1                                        | SERVER_ID1                                        | SERVER_ID1                                        | 0                                                 | 0                                                 | 0                                                 | 0                                                 | SRV1                                              | SRV1                                              | SRV1                                              | SRV1                                              |
| W        |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C |
|          | 16                                                | 17                                                | 18                                                | 19                                                | 20                                                | 21                                                | 22                                                | 23                                                | 24                                                | 25                                                | 26                                                | 27                                                | 28                                                | 29                                                | 30                                                | 31                                                |
| R        | REN2                                              | RSC2                                              | 0                                                 | 0                                                 | SERVER_ID2                                        | SERVER_ID2                                        | SERVER_ID2                                        | SERVER_ID2                                        | 0                                                 | 0                                                 | 0                                                 | 0                                                 | SRV2                                              | SRV2                                              | SRV2                                              | SRV2                                              |
| W        |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C | eTPU A: Base + 0x0_002C / eTPU B: Base + 0x0_004C |

Table 18-15.  ETPU\_REDCR Field Descriptions

| Bits   | Name        | Description                                                                                                                                                                                                                                                                                                                                                                                                        |
|--------|-------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0      | REN1        | TCR1resource 1 client/server operation enable. Enables or disables client/server operation for the eTPU STAC interface. REN1 enables TCR1. 0 Server/client operation for resource 1 is disabled. 1 Server/client operation for resource 1 is enabled.                                                                                                                                                              |
| 1      | RSC1        | TCR1 resource server/client assignment. Selects the eTPU data resource assignment to be used as a server or client. RSC1 selects the functionality of TCR1. For server mode, external plugging determines the unique server address assigned to each TCR. For a client mode, the SRV1 field determines the server address to which the client listens. 0 Resource client operation. 1 Resource server operation.   |
| 2-3    | -           | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                          |
| 4-7    | SERVER_ID 1 | STAC bus address for TCR1 as a server. For more information on the STAC interface, refer to the eTPU reference manual.                                                                                                                                                                                                                                                                                             |
| 8-11   | -           | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                          |
| 12-15  | SRV1 [0:3]  | TCR1resource server. Selects the address of the specific STAC Server the local TCR1will listen to when configured as a STAC client. For more information on the STAC interface, refer to the eTPU reference manual.                                                                                                                                                                                                |
| 16     | REN2        | TCR2resource 1 client/server operation enable. Enables or disables client/server operation for eTPU slave resources. REN2 enables TCR2 slave bus operations. 1 Server/client operation for resource 2 is enabled. 0 Server/client operation for resource 2 is disabled.                                                                                                                                            |
| 17     | RSC2        | TCR2 2 resource server/client assignment. Selects the eTPU data resource assignment to be used as a server or client. RSC2 selects the functionality of TCR2. For server mode, external plugging determines the unique server address assigned to each TCR. For a client mode, the SRV2 field determines the Server address to which the client listens. 0 Resource Client operation. 1 Resource Server operation. |
| 18-19  | -           | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                          |

## MPC5553/MPC5554 Microcontroller Reference Manual, Rev. 3.1

Table 18-15.  ETPU\_REDCR Field Descriptions (continued)

| Bits   | Name        | Description                                                                                                                                                                                                       |
|--------|-------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 20-23  | SERVER_ID 2 | STAC bus address for TCR2 as a server.                                                                                                                                                                            |
| 24-27  | -           | Reserved.                                                                                                                                                                                                         |
| 28-31  | SRV2 [0:3]  | TCR2 resource server. Selects the address of the specific STAC server the local TCR2 listens to when configured as a STAC Client. For more information on the STAC interface, refer to the eTPU reference manual. |

- 1 Resource identifies any parameter that changes in time and can be exported / imported from other device. For the eTPU, a resource can be TCR1 or TCR2 (either time or angle values).
- 2 When TCR2 is configured as a STAC bus client (REN2 = 1, RSC2 = 0) the angle clock hardware must be disabled (ETPU\_TBCR[AM] = 0).

## 18.4.2.3 Global Channel Registers

The registers in this section group, by type, the interrupt status and enable bits from all the channels. This organization eases management of all channels or groups of channels by a single interrupt handler routine. These bits are mirrored by the individual channel registers.

## 18.4.2.3.1 eTPU Channel Interrupt Status Register (ETPU\_CISR)

Host interrupt status from all channels are grouped in ETPU\_CISR. The bits are mirrored by the channels' status/control registers. For more information, refer to Section 18.4.2.4.3, 'eTPU Channel n Status Control Register (ETPU\_CnSCR),' and the eTPU reference manual.

## NOTE

The host core must write 1 to clear an interrupt status bit.

Figure 18-14. eTPU Channel Interrupt Status Register (ETPU\_CISR)

<!-- image -->

|          | 0                                                 | 1                                                 | 2                                                 | 3                                                 | 4                                                 | 5                                                 | 6                                                 | 7                                                 | 8                                                 | 9                                                 | 10                                                | 11                                                | 12                                                | 13                                                | 14                                                | 15                                                |
|----------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|
| R        | CIS31                                             | CIS30                                             | CIS29                                             | CIS28                                             | CIS27                                             | CIS26                                             | CIS25                                             | CIS24                                             | CIS23                                             | CIS22                                             | CIS21                                             | CIS20                                             | CIS19                                             | CIS18                                             | CIS17                                             | CIS16                                             |
| W        | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 |
|          | 16                                                | 17                                                | 18                                                | 19                                                | 20                                                | 21                                                | 22                                                | 23                                                | 24                                                | 25                                                | 26                                                | 27                                                | 28                                                | 29                                                | 30                                                | 31                                                |
| R        | CIS15                                             | CIS14                                             | CIS13                                             | CIS12                                             | CIS11                                             | CIS10                                             | CIS9                                              | CIS8                                              | CIS7                                              | CIS6                                              | CIS5                                              | CIS4                                              | CIS3                                              | CIS2                                              | CIS1                                              | CIS0                                              |
| W        | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 | eTPU A: Base + 0x0_0200 / eTPU B: Base + 0x0_0204 |

## Table 18-16.  ETPU\_CISR Field Descriptions

| Bits   | Name   | Description                                                                                                                                                                                                                                                                                 |
|--------|--------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0-31   | CIS n  | Channel n interrupt status. 0 indicates that channel n has no pending interrupt to the host core. 1 indicates that channel n has a pending interrupt to the host core. To clear a status bit, the host must write 1 to it. For details about interrupts refer to the eTPU reference manual. |

## 18.4.2.3.2 eTPU Channel Data Transfer Request Status Register (ETPU\_CDTRSR)

Data transfer request status from all channels are grouped in ETPU\_CDTRSR. The bits are mirrored by the channels' status/control registers. For more information on data transfers and channel control registers, see the eTPU reference manual.

In the MPC5554, eTPU A channels [0:2,12:15,28:29] and eTPU B channels [0:3,12:15,28:31]  are  connected  to  the  DMA;  in  the  MPC5553,  eTPU channels [0:2, 14:15] are DMA connected. The data transfer request lines that are not connected to the DMA controller are left disconnected and do not generate transfer requests, even if their request status bits are asserted in registers  ETPU\_CDTRSR  and  ETPU\_C n SCR.  Channels  that  are  not connected may still have their status bits (DTRS n ) cleared by writing a 1 to the appropriate field .

Figure 18-15. eTPU Channel Data Transfer Request Status Register (ETPU\_CDTRSR)

<!-- image -->

| 0                                                 | 1                                                 | 2                                                 | 3                                                 | 4                                                 | 5                                                 | 6                                                 | 7                                                 | 8                                                 | 9                                                 | 10                                                | 11                                                | 12                                                | 13                                                | 14                                                | 15                                                |
|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|
| R DTRS 31                                         | DTRS 30                                           | DTRS 29                                           | DTRS 28                                           | DTRS 27                                           | DTRS 26                                           | DTRS 25                                           | DTRS 24 w1c                                       | DTRS 23                                           | DTRS 22                                           | DTRS 21 w1c                                       | DTRS 20 w1c                                       | DTRS 19 w1c                                       | DTRS 18 w1c                                       | DTRS 17 w1c                                       | DTRS 16 w1c                                       |
| W w1c Reset 0                                     | w1c 0                                             | w1c 0                                             | w1c 0                                             | w1c 0                                             | w1c 0                                             | w1c 0                                             | 0                                                 | w1c 0                                             | w1c 0                                             | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 |

|          | 16                                                | 17                                                | 18                                                | 19                                                | 20                                                | 21                                                | 22                                                | 23                                                | 24                                                | 25                                                | 26                                                | 27                                                | 28                                                | 29                                                | 30                                                | 31                                                |
|----------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|
| R        | DTRS 15                                           | DTRS 14                                           | DTRS 13                                           | DTRS 12                                           | DTRS 11                                           | DTRS 10                                           | DTRS 9                                            | DTRS 8                                            | DTRS 7                                            | DTRS 6                                            | DTRS 5                                            | DTRS 4                                            | DTRS 3                                            | DTRS 2                                            | DTRS 1                                            | DTRS 0                                            |
| W        | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 | eTPU A: Base + 0x0_0210 / eTPU B: Base + 0x0_0214 |

Table 18-17.  ETPU\_CDTRSR Field Descriptions

| Bits   | Name   | Description                                                                                                                                                                                                                                                                                               |
|--------|--------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0-31   | DTRS n | Channel n data transfer request status. 0 Indicates that channel n has no pending data transfer request. 1 Indicates that channel n has a pending data transfer request. To clear a status bit, the host must write 1 to it. For details about data transfer requests refer to the eTPU reference manual. |

## 18.4.2.3.3 eTPU Channel Interrupt Overflow Status Register (ETPU\_CIOSR)

An interrupt overflow occurs when an interrupt is issued for a channel when the previous interrupt status bit for the same channel has not been cleared. Interrupt overflow status from all channels are grouped in ETPU\_CIOSR. The bits are mirrored by the channels' status/control registers.  For  information  about channel  status  registers  and  overflow,  refer  to  Section 18.4.2.4.3,  'eTPU  Channel  n  Status  Control Register (ETPU\_CnSCR),' and the eTPU reference manual.

NOTE

The host must write 1 to clear an interrupt overflow status bit.

Figure 18-16. eTPU Channel Interrupt Overflow Status Register (ETPU\_CIOSR)

<!-- image -->

|          | 0                                                 | 1                                                 | 2                                                 | 3                                                 | 4                                                 | 5                                                 | 6                                                 | 7                                                 | 8                                                 | 9                                                 | 10                                                | 11                                                | 12                                                | 13                                                | 14                                                | 15                                                |
|----------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|
| R        | CIOS 31                                           | CIOS 30                                           | CIOS 29                                           | CIOS 28                                           | CIOS 27                                           | CIOS 26                                           | CIOS 25                                           | CIOS 24                                           | CIOS 23                                           | CIOS 22                                           | CIOS 21                                           | CIOS 20                                           | CIOS 19                                           | CIOS 18                                           | CIOS 17                                           | CIOS 16                                           |
| W        | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 |
|          | 16                                                | 17                                                | 18                                                | 19                                                | 20                                                | 21                                                | 22                                                | 23                                                | 24                                                | 25                                                | 26                                                | 27                                                | 28                                                | 29                                                | 30                                                | 31                                                |
| R        | CIOS 15                                           | CIOS 14                                           | CIOS 13                                           | CIOS 12                                           | CIOS 11                                           | CIOS 10                                           | CIOS 9                                            | CIOS 8                                            | CIOS 7                                            | CIOS 6                                            | CIOS 5                                            | CIOS 4                                            | CIOS 3                                            | CIOS 2                                            | CIOS 1                                            | CIOS 0                                            |
| W        | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               | w1c                                               |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 | eTPU A: Base + 0x0_0220 / eTPU B: Base + 0x0_0224 |

Table 18-18.  ETPU\_CIOSR Field Descriptions

| Bits   | Name   | Description                                                                                                                                                                                                                                                                               |
|--------|--------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0-31   | CIOS n | Channel n interrupt overflow status. 0 indicates that no interrupt overflow occurred in the channel. 1 indicates that an interrupt overflow occurred in the channel. To clear a status bit, the host must write 1 to it. For details about interrupts refer to the eTPU reference manual. |

## 18.4.2.3.4 eTPU Channel Data Transfer Request Overflow Status Register (ETPU\_CDTROSR)

Data transfer request overflow status from all channels are grouped in ETPU\_CDTROSR. The bits are mirrored by the channels' status/control registers. For more information on channel status registers and data  transfer  request  overflow,  refer  to  Section 18.4.2.4.3,  'eTPU  Channel  n  Status  Control  Register (ETPU\_CnSCR),' and the eTPU reference manual.

## NOTE

The host must write 1 to clear a data transfer request overflow status bit.

Figure 18-17. eTPU Channel Data Transfer Request Overflow Status Register (ETPU\_CDTROSR)

<!-- image -->

Table 18-19.  ETPU\_CDTROSR Field Descriptions

| Bits   | Name    | Description                                                                                                                                                                                                                                                                                                                                      |
|--------|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0-31   | DTROS n | Channel n data transfer request overflow status. 0 indicates that no data transfer request overflow occurred in the channel 1 indicates that a data transfer request overflow occurred in the channel. To clear a status bit, the host must write 1 to it. For details about data transfer request overflow, refer to the eTPU reference manual. |

## 18.4.2.3.5 eTPU Channel Interrupt Enable Register (ETPU\_CIER)

The host interrupt enable bits for all 32 channels are grouped in ETPU\_CIER. The bits are mirrored by the channel configuration registers. For more information on channel configuration registers and interrupt enable, refer to Section 18.4.2.4.2, 'eTPU Channel n Configuration Register (ETPU\_CnCR),' and the eTPU reference manual.

Figure 18-18. eTPU Channel Interrupt Enable Register (ETPU\_CIER)

<!-- image -->

## Table 18-20.  ETPU\_CIER Field Descriptions

| Bits   | Name   | Description                                                                                                                                                                                                                           |
|--------|--------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0-31   | CIE n  | Channel n interrupt enable. Enable the eTPU channels to interrupt the MPC5553 / MPC5554 core. 0 Interrupt disabled for channel n . 1 Interrupt enabled for channel n For details about interrupts refer to the eTPU reference manual. |

## 18.4.2.3.6 eTPU Channel Data Transfer Request Enable Register (ETPU\_CDTRER)

Data transfer request enable status bits from all channels are grouped in ETPU\_CDTRER. The bits are mirrored in the channels' configuration registers. For more on configuration registers and data transfer request enable, refer to Section 18.4.2.4.2, 'eTPU Channel n Configuration Register (ETPU\_CnCR),' and the eTPU reference manual.

Figure 18-19. eTPU Channel Data Transfer Request Enable Register (ETPU\_CDTRER)

<!-- image -->

## Table 18-21.  ETPU\_CDTRER Field Descriptions

| Bits   | Name   | Description                                                                                                                                                                                                                                                            |
|--------|--------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0-31   | DTRE n | Channel n data transfer request enable. Enable data transfer requests for their respective channels. 0 Data transfer request disabled for channel n . 1 Data transfer request enabled for channel n . For details about interrupts refer to the eTPU reference manual. |

## 18.4.2.3.7 eTPU Channel Pending Service Status Register (ETPU\_CPSSR)

ETPU\_CPSSR is a read-only register that holds the status of the pending channel service requests. For information on channel service requests, refer to the eTPU reference manual.

## NOTE

More than one source may be requesting service when a channel's service request bit is set.

Figure 18-20. eTPU Channel Pending Service Status Register (ETPU\_CPSSR)

<!-- image -->

|          | 0                                                 | 1                                                 | 2                                                 | 3                                                 | 4                                                 | 5                                                 | 6                                                 | 7                                                 | 8                                                 | 9                                                 | 10                                                | 11                                                | 12                                                | 13                                                | 14                                                | 15                                                |
|----------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|
| R        | SR31                                              | SR30                                              | SR29                                              | SR28                                              | SR27                                              | SR26                                              | SR25                                              | SR24                                              | SR23                                              | SR22                                              | SR21                                              | SR20                                              | SR19                                              | SR18                                              | SR17                                              | SR16                                              |
| W        |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 |
|          | 16                                                | 17                                                | 18                                                | 19                                                | 20                                                | 21                                                | 22                                                | 23                                                | 24                                                | 25                                                | 26                                                | 27                                                | 28                                                | 29                                                | 30                                                | 31                                                |
| R        | SR15                                              | SR14                                              | SR13                                              | SR12                                              | SR11                                              | SR10                                              | SR9                                               | SR8                                               | SR7                                               | SR6                                               | SR5                                               | SR4                                               | SR3                                               | SR2                                               | SR1                                               | SR0                                               |
| W        |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 | eTPU A: Base + 0x0_0280 / eTPU B: Base + 0x0_0284 |

## Table 18-22.  ETPU\_CPSSR Bit Field Descriptions

| Bits   | Name   | Description                                                                                                                                                                                                                                                                        |
|--------|--------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0-31   | SR n   | Pending service request n . Indicates a pending service request for channel n . The SR status for the pending request is negated at the time slot transition for the respective service thread. 0 no service request pending for channel n 1 pending service request for channel n |

## NOTE

The pending service status bit for a channel is set when a service request is pending, even if the Channel is disabled (CPR n = 0).

## 18.4.2.3.8 eTPU Channel Service Status Register (ETPU\_CSSR)

ETPU\_CSSR holds the current channel service status on whether it is being serviced or not. Only one bit may be asserted in this register at a given time. When no channel is being serviced the register read value is  0x0000\_0000.  ETPU\_CSSR is a read-only  register.  The  register  can  be  read  during  normal  eTPU operation for monitoring the scheduler activity. For more information on channels being serviced, refer to the eTPU reference manual.

## NOTE

The ETPU\_CSSR is not an absolute indication of channel status. If more than one source is requesting service, the asserted status bit only indicates that one of the requests has been granted.

## NOTE

Channel  service  status  does  not  always  reflect  decoding  of  the  CHAN register,  since  the  CHAN  register  can  be  changed  by  the  service  thread microcode.

Figure 18-21. ETPU\_CSSR Register

<!-- image -->

|          | 0                                                 | 1                                                 | 2                                                 | 3                                                 | 4                                                 | 5                                                 | 6                                                 | 7                                                 | 8                                                 | 9                                                 | 10                                                | 11                                                | 12                                                | 13                                                | 14                                                | 15                                                |
|----------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|---------------------------------------------------|
| R        | SS31                                              | SS30                                              | SS29                                              | SS28                                              | SS27                                              | SS26                                              | SS25                                              | SS24                                              | SS23                                              | SS22                                              | SS21                                              | SS20                                              | SS19                                              | SS18                                              | SS17                                              | SS16                                              |
| W        |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 |
|          | 16                                                | 17                                                | 18                                                | 19                                                | 20                                                | 21                                                | 22                                                | 23                                                | 24                                                | 25                                                | 26                                                | 27                                                | 28                                                | 29                                                | 30                                                | 31                                                |
| R        | SS15                                              | SS14                                              | SS13                                              | SS12                                              | SS11                                              | SS10                                              | SS9                                               | SS8                                               | SS7                                               | SS6                                               | SS5                                               | SS4                                               | SS3                                               | SS2                                               | SS1                                               | SS0                                               |
| W        |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |                                                   |
| Reset    | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 | 0                                                 |
| Reg Addr | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 | eTPU A: Base + 0x0_0290 / eTPU B: Base + 0x0_0294 |

## Table 18-23.  ETPU\_CSSR Field Descriptions

| Bits   | Name   | Description                                                                                                                                                                                                                                                                                                   |
|--------|--------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0-31   | SS n   | Service status n . Indicates that channel n is currently being serviced. It is updated at the 1st microcycle of a time slot transition. 0 channel n is not currently being serviced 1 channel n is currently being serviced Refer to the eTPU reference manual for more information on time slot transitions. |

## 18.4.2.4 Channel Configuration and Control Registers

Each channel, for both eTPU engines, has a group of three registers used to control, configure and check status of that channel as shown in Table 18-24.

Table 18-24. Channel Registers Structure

| Channel Offset   | Register Name                                              |
|------------------|------------------------------------------------------------|
| 0x00             | eTPU channel configuration register (ETPU_C n CR)          |
| 0x04             | eTPU channel status/control register 1 (ETPU_C n SCR)      |
| 0x08             | eTPU channel host service request register (ETPU_C n HSRR) |
| 0x0C             | Reserved                                                   |

- 1 In the MPC5554, eTPU A channels [0:2,12:15,28:29] and eTPU B channels [0:3,12:15,28:31] are connected to the DMA; in the MPC5553, eTPU A channels [0:2, 14:15] are connected. The data transfer request lines that are not connected to the DMA controller are left disconnected and do not generate interrupt requests, even if their request status bits assert in registers ETPU\_CDTRSR and ETPU\_C SCR n

## 18.4.2.4.1 Channel Registers Layout

One contiguous area is used to map all channel registers of each eTPU engine as shown in Table 18-25.

Table 18-25. eTPU Channel Register Map

| Address                          | Registers Structure                  |
|----------------------------------|--------------------------------------|
| Base + 0x0_0400                  | eTPU A channel 0 register structure  |
| Base + 0x0_0410                  | eTPU A channel 1 register structure  |
| Base + 0x0_0420                  | eTPU A channel 2 register structure  |
| Base + 0x0_0430- Base + 0x0_05D0 | . . .                                |
| Base + 0x0_05E0                  | eTPU A channel 30 register structure |
| Base + 0x0_05F0                  | eTPU A channel 31 register structure |
| Base + 0x0_0600- Base + 0x0_07FF | Reserved                             |
| Base + 0x0_0800                  | eTPU B channel 0 register structure  |
| Base + 0x0_0810                  | eTPU B channel 1 register structure  |
| Base + 0x0_0820                  | eTPU B channel 2 register structure  |
| Base + 0x0_0430- Base + 0x0_05D0 | . . .                                |
| Base + 0x0_09E0                  | eTPU B channel 30 register structure |
| Base + 0x0_09F0                  | eTPU B channel 31 register structure |
| Base + 0x0_0A0 - Base + 0x0_0BFF | Reserved                             |

There are 64 structures defined, one for each available channel in the eTPU System (32 for each engine). The base address for the structure presented can be calculated by using the following equation:

Channel\_Register\_Structure\_Base\_Address =

ETPU\_Engine\_Channel\_Base + (channel\_number * 0x0\_0010)

where:

ETPU\_Engine\_Channel\_Base = ETPU\_Base + (0x0\_0400 for engine A or 0x0\_0800 for engine B).

## 18.4.2.4.2 eTPU Channel n Configuration Register (ETPU\_C n CR)

The ETPU\_C CR is a collection of the configuration bits related to an individual channel. Some of these n bits are mirrored from the global channel registers.

Figure 18-22. eTPU Channel n Configuration Register (ETPU\_C n CR)

<!-- image -->

1 ETPD is only offered in the MPC5553.

Table 18-26.  ETPU\_C n CR Field Descriptions

|   Bits | Name   | Description                                                                                                                                                                                                                                 |
|--------|--------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|      0 | CIE    | Channel interrupt enable. This bit is mirrored from the ETPU_CIER 0 Disable interrupt for this channel.For more information, refer to the eTPU reference manual. 1 Enable interrupt for this channel.                                       |
|      1 | DTRE   | Channel data transfer request enable. This bit is mirrored from the ETPU_CDTRER. 0 Disable data transfer request for this channel.Refer to the eTPU reference manual for more information. 1 Enable data transfer request for this channel. |

Table 18-26.  ETPU\_C n CR Field Descriptions (continued)

| Bits   | Name                                                                                | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|--------|-------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 2-3    | CPR [0:1]                                                                           | Channel priority. Defines the priority level for the channel. The priority level is used by the hardware scheduler. The values for CPR[1:0] and corresponding levels are shown in the table below.                                                                                                                                                                                                                                                                                                                       |
|        |                                                                                     | 00 Disabled                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|        |                                                                                     | 01 Low                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|        |                                                                                     | 10 Middle                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|        |                                                                                     | 11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|        |                                                                                     | High                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|        | For more information on the hardware scheduler, refer to the eTPU reference manual. | For more information on the hardware scheduler, refer to the eTPU reference manual.                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 4-5    | -                                                                                   | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 6      | ETPD                                                                                | This bit selects which channel signal, input or output, is used in the entry point selection. The ETPD value has to be compatible with the function chosen for the channel, selected in the field CFS. For details about entry table and condition encoding schemes, refer to the eTPU reference manual. The ETPD bit is only present in the MPC5553. 1 = Use PSTO for entry point selection. 0 = Use PSTI for entry point selection.                                                                                    |
| 7      | ETCS                                                                                | Entry table condition select. Determines the channel condition encoding scheme that selects the entry point to be taken in an entry table. The ETCS value has to be compatible with the function chosen for the channel, selected in ETPU_C n CR[CFS]. Two condition encoding schemes are available. 1 Select alternate entry table condition encoding scheme. 0 Select standard entry table condition encoding scheme.For details about entry table and condition encoding schemes, refer to the eTPU reference manual. |
| 8-10   | -                                                                                   | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 11-15  | CFS [0:4]                                                                           | Channel function select. Defines the function to be performed by the channel. The function assigned to the channel has to be compatible with the channel condition encoding scheme, selected by ETPU_C n CR[ETCS]. For more information about functions, refer to the eTPU reference manual.                                                                                                                                                                                                                             |
| 16     | ODIS                                                                                | Output disable. Enables the channel to have its output forced to the value opposite to OPOL when the output disable input signal corresponding to the channel group that it belongs is active. 0 Turns off the output disable feature for the channel.For more information on output disable, refer to the eTPU reference manual. 1 Turns on the output disable feature for the channel                                                                                                                                  |
| 17     | OPOL                                                                                | Output polarity. Determines the output signal polarity. The activation of the output disable signal forces, when enabled by ETPU_C n CR[ODIS], the channel output signal to the opposite of this polarity. 0 Output active low (output disable drives output to high) 1 Output active high (output disable drives output to low)                                                                                                                                                                                         |

Table 18-26.  ETPU\_C n CR Field Descriptions (continued)

| Bits   | Name        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|--------|-------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 18-20  | -           | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 21-31  | CPBA [0:10] | Channel n parameter base address. The value of this field multiplied by 8 specifies the SDM parameter base host (byte) address for channel n (2-parameter granularity). The formula for calculating the absolute channel parameter base (byte) address, as seen by the host, is eTPU_Base + 0x8000 + CPBA*8. The SDM is mirrored in the parameter sign extension (PSE) area. The formula to calculate the absolute channel parameter base (byte) address in the PSE area is eTPU_Base + 0xC000 + CPBA*8. For more information on SDM addresses, refer to the eTPU reference manual. |

## 18.4.2.4.3 eTPU Channel n Status Control Register (ETPU\_C n SCR)

ETPU\_C SCR is a collection of the  interrupt  status  bits  of  the  channel,  and  also  the  function  mode n definition (read-write). Bits CIS, CIOS, DTRS, and DTROS for each channel can also be accessed from ETPU\_CISR, ETPU\_CIOSR, ETPU\_CDTRSR,  and ETPU\_CDTROSR  respectively. For more information on the three previously mentioned registers, refer to the eTPU reference manual.

## NOTE

The MPC5553/MPC5554 core must write 1 to clear a status bit.

## NOTE

In the MPC5554, eTPU A channels [0:2,12:15,28:29] and eTPU B channels [0:3,12:15,28:31] are connected to the DMA; in the MPC5553, eTPU A channels [0:2, 14:15] are DMA connected. The data transfer request lines that are not connected to the DMA controller are left disconnected and do not  generate  transfer  requests,  even  if  their  request  status  bits  assert  in registers ETPU\_CDTRSR and ETPU\_C SCR n

Figure 18-23. eTPU Channel n Status Control Register (ETPU\_C n SCR)

<!-- image -->

## Table 18-27.  ETPU\_C n SCR Field Descriptions

| Bits   | Name   | Description                                                                                                                                                                                                                                                                                                                                                                                                |
|--------|--------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0      | CIS    | Channel interrupt status. 0 Channel has no pending interrupt to the MPC5553 / MPC5554 core. 1 Channel has a pending interrupt to the MPC5553 / MPC5554 core. CIS is mirrored in the ETPU_CISR. For more information on ETPU_CISR and interrupts, see Section 18.4.2.3.1, 'eTPU Channel Interrupt Status Register (ETPU_CISR),' and the eTPU reference manual.                                              |
| 0      | CIC    | Channel interrupt clear. 0 Keep interrupt status bit unaltered. 1 Clear interrupt status bit. CIS and CIC are mirrored in the ETPU_CISR. For more information on ETPU_CISR and interrupts, see Section 18.4.2.3.1, 'eTPU Channel Interrupt Status Register (ETPU_CISR),' and eTPU reference manual.                                                                                                        |
| 1      | CIOS   | Channel interrupt overflow status. 0 Interrupt overflow negated for this channel 1 Interrupt overflow asserted for this channel CIOS is mirrored in the ETPU_CIOSR. For more information on the ETPU_CIOSR and interrupt overflow, see Section 18.4.2.3.3, 'eTPU Channel Interrupt Overflow Status Register (ETPU_CIOSR).' and the eTPU reference manual.                                                  |
| 2-7    | -      | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                  |
| 8      | DTRS   | Data transfer request status. 0 Channel has no pending data transfer request. 1 Channel has a pending data transfer request. DTRS is mirrored in the ETPU_CISR. For more information on the ETPU_CISR and data transfer, see Section 18.4.2.3.2, 'eTPU Channel Data Transfer Request Status Register (ETPU_CDTRSR).' and the eTPU reference manual.                                                        |
| 9      | DTROS  | Data transfer request overflow status. 0 Data transfer request overflow negated for this channel. 1 Data transfer request overflow asserted for this channel. DTROS is mirrored in the ETPU_CDTROSR. See Section 18.4.2.3.4, 'eTPU Channel Data Transfer Request Overflow Status Register (ETPU_CDTROSR).' and the eTPU reference manual for more information on ETPU_CDTROSR and data transfer overflows. |
| 10-15  | -      | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                  |
| 16     | IPS    | Channel input pin state. Shows the current value of the filtered channel input signal state                                                                                                                                                                                                                                                                                                                |
| 17     | OPS    | Channel output pin state. Shows the current value driven in the channel output signal, including the effect of the external output disable feature. If the channel input and output signals are connected to the same pad, OPS reflects the value driven to the pad . This is not necessarily the actual pad value, which drives the value in the IPS bit.                                                 |

## MPC5553/MPC5554 Microcontroller Reference Manual, Rev. 3.1

Table 18-27.  ETPU\_C n SCR Field Descriptions (continued)

| Bits   | Name     | Description                                                                                                                         |
|--------|----------|-------------------------------------------------------------------------------------------------------------------------------------|
| 18-29  | -        | Reserved.                                                                                                                           |
| 30-31  | FM [0:1] | Channel function mode. 1 Each function may use this field for specific configuration. These bits can be tested by microengine code. |

1 These bits are equivalent to the TPU/TPU2/TPU3 host sequence (HSQ) bits.

## 18.4.2.4.4 eTPU Channel n Host Service Request Register (ETPU\_C n HSRR)

ETPU\_C HSRR is used by the MPC5553/MPC5554 core to issue service requests to the channel. n

Figure 18-24. eTPU Channel n Host Service Request Register (ETPU\_CnHSRR)

<!-- image -->

|          | 0                            | 1                            | 2                            | 3                            | 4                            | 5                            | 6                            | 7                            | 8                            | 9                            | 10                           | 11                           | 12                           | 13                           | 14                           | 15                           |
|----------|------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|------------------------------|
| R        | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            |
| W        |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |
| Reset    | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            |
| Reg Addr | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 |
|          | 16                           | 17                           | 18                           | 19                           | 20                           | 21                           | 22                           | 23                           | 24                           | 25                           | 26                           | 27                           | 28                           | 29                           | 30                           | 31                           |
| R        | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            |                              | HSR                          |                              |
| W        |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |                              |
| Reset    | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            | 0                            |
| Reg Addr | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 | Channel_Register_Base + 0x08 |

Table 18-28.  ETPU\_C n HSRR Field Descriptions

| Bits   | Name      | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|--------|-----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0-28   | -         | Reserved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 29-31  | HSR [0:2] | Host service request. Used by the host core to request service to the channel GLYPH<127> HSR = 000: no host service request pending GLYPH<127> HSR > 000: function-dependent host service request pending. The HSRvalueturns to 000 automatically at the end of microengine service for that channel. The host should write HSR > 0 only when HSR = 0. Writing HSR = 000 withdraws a pending request if the scheduler has not started to resolve the entry point, however once the scheduler starts resolving, the service thread will not be aborted. |

## 18.5 Functional Description

Refer to the eTPU User's Manual for information regarding the functional description of the eTPU module.

## 18.6 Initialization/Application Information

After initial power-on reset, the eTPU remains in an idle state (except when debug is asserted on power-on reset-in this case, the microengines awakens in halt state). In addition, the SCM should be initialized with the eTPU application prior to configuring the eTPU.

## 18.7 Revision History

## Substantive Changes since Rev 3.0

```
Added Table 18-12, the bit field descriptions of ETPU_TBCR along with the Note above it.
```
